<?xml version="1.0" encoding="utf-8"?>
<Simulations xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" Version="3">
  <Name>Simulations</Name>
  <Replacements>
    <Name>Replacements</Name>
    <Plant>
      <Name>Grapevine</Name>
      <Memo>
        <Name>TitlePage</Name>
        <MemoText><![CDATA[
# The APSIM Grapevine Model

ZHU, J., Brown, H.E., Parker, A.K.,Trought, M.C.T.

##Building the model.
The APSIM Grapevine model has been adapted from the potato model [Brown_etal_2011] and developed using the Plant Modelling Framework (PMF) of [brown_plant_2014]. This new framework provides a library of plant organ and process submodels that can be coupled, at runtime, to construct a model in much the same way that models can be coupled to construct a simulation. This means that dynamic composition of lower level process and organ classes (e.g. photosynthesis, leaf) into larger constructions (e.g. maize, wheat, sorghum) can be achieved by the model developer without additional coding.

The model consists of:
* a phenology model to simulate development between growth phases   
* a structure model to simulate plant morphology  
* a collection of organs to simulate the various plant parts  
* an arbitrator to allocate resources (N, biomass) to the various plant organs  

##Pecularities of Grapevine
Grapevine is a challenging crop to model because it is a perennial woody plant. 
A budding phase was added for simulating the start of the vegetative phase. This budding phase was similar to the emergence phase for annual crop.
There are an enormous number of Grapevine cultivars and trainning systems. They differ in phenology and vegetative growth. 

##Including a Grapevine crop in an APSIM simulation
To indluce a Grapevine crop in a simulation the grapevine plant needs to be added to the vineyard, field or zone in which it is to be grown.  This can be done by right clicking on the vineyard, selecting Add from the drop down menu and then selecting Plant from the list that comes up.  
###Setting plant density and bud number (budNumber number and early canopy growth)
The Grapevine Management script sets the number of stems that will appear from plant.  
###Setting final leaf number (Crop duration)
The duration of a Grapevine crop is determined by the number of leaves that the mainstem produces and how long it takes for these to appear and seness.]]></MemoText>
      </Memo>
      <Cultivar>
        <Name>SauvignonBlanc</Name>
      </Cultivar>
      <Phenology>
        <Name>Phenology</Name>
        <AirTemperatureFunction>
          <Name>ThermalTime</Name>
          <XYPairs>
            <Name>XYPairs</Name>
            <X>
              <double>0</double>
              <double>30</double>
              <double>35</double>
              <double>40</double>
              <double>45</double>
            </X>
            <Y>
              <double>0</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </Y>
          </XYPairs>
        </AirTemperatureFunction>
        <GenericPhase>
          <Name>Dormant</Name>
          <Constant>
            <Name>Target</Name>
            <FixedValue>13.5</FixedValue>
            <Units>days</Units>
          </Constant>
          <AirTemperatureFunction>
            <Name>ThermalTime</Name>
            <XYPairs>
              <Name>XYPairs</Name>
              <X>
                <double>0</double>
                <double>4</double>
                <double>8</double>
                <double>20</double>
              </X>
              <Y>
                <double>1</double>
                <double>1</double>
                <double>0</double>
                <double>0</double>
              </Y>
            </XYPairs>
          </AirTemperatureFunction>
          <Start>StartDomancy</Start>
          <End>EndDomancy</End>
        </GenericPhase>
        <BuddingPhase>
          <Name>Budding</Name>
          <Memo>
            <Name>Memo</Name>
            <MemoText><![CDATA[During the vegetative phase the crop is only growing stem, root and leaf.  Tuber initiation usually occurs soon after emergence and the duration of this phase can be influenced by the physiological status of the seed tuber at planting.  As discussed above, we do not have a suitable method for modelling this yet so we have treated the time from emergence to tuber initiation as a thermal time constant.]]></MemoText>
          </Memo>
          <VariableReference>
            <Name>ThermalTime</Name>
            <VariableName>[Phenology].ThermalTime.Value()</VariableName>
          </VariableReference>
          <MultiplyFunction>
            <Name>Target</Name>
            <Constant>
              <Name>Base</Name>
              <FixedValue>51</FixedValue>
            </Constant>
            <LinearInterpolationFunction>
              <Name>ChillingTadjustment</Name>
              <XYPairs>
                <Name>XYPairs</Name>
                <X>
                  <double>5</double>
                  <double>13.8</double>
                  <double>23.3</double>
                  <double>32.7</double>
                  <double>42</double>
                </X>
                <Y>
                  <double>1</double>
                  <double>0.66</double>
                  <double>0.53</double>
                  <double>0.46</double>
                  <double>0.43</double>
                </Y>
              </XYPairs>
              <XProperty>[Budding].AccChill.Value()</XProperty>
            </LinearInterpolationFunction>
          </MultiplyFunction>
          <AccumulateFunction>
            <Name>AccChill</Name>
            <VariableReference>
              <Name>ThermalTime</Name>
              <VariableName>[Phenology].Dormant.ThermalTime.Value()</VariableName>
            </VariableReference>
            <StartStageName>StartDomancy</StartStageName>
            <EndStageName>BudBurst</EndStageName>
            <ResetStageName>StartDomancy</ResetStageName>
          </AccumulateFunction>
          <Start>EndDomancy</Start>
          <End>BudBurst</End>
        </BuddingPhase>
        <GenericPhase>
          <Name>ShootGrowth</Name>
          <Constant>
            <Name>Target</Name>
            <FixedValue>29</FixedValue>
          </Constant>
          <VariableReference>
            <Name>ThermalTime</Name>
            <VariableName>[Phenology].ThermalTime.Value()</VariableName>
          </VariableReference>
          <Start>BudBurst</Start>
          <End>StartFlowering</End>
        </GenericPhase>
        <GenericPhase>
          <Name>FlowerDevelopment</Name>
          <Constant>
            <Name>Target</Name>
            <FixedValue>7</FixedValue>
            <Units>dd</Units>
          </Constant>
          <VariableReference>
            <Name>ThermalTime</Name>
            <VariableName>[Phenology].ThermalTime.Value()</VariableName>
          </VariableReference>
          <Start>StartFlowering</Start>
          <End>FruitSet</End>
        </GenericPhase>
        <GenericPhase>
          <Name>BerryDevelopment</Name>
          <Constant>
            <Name>Target</Name>
            <FixedValue>20</FixedValue>
          </Constant>
          <AirTemperatureFunction>
            <Name>ThermalTime</Name>
            <XYPairs>
              <Name>XYPairs</Name>
              <X>
                <double>0</double>
                <double>25</double>
                <double>35</double>
                <double>40</double>
              </X>
              <Y>
                <double>0</double>
                <double>1</double>
                <double>1</double>
                <double>0</double>
              </Y>
            </XYPairs>
          </AirTemperatureFunction>
          <Start>FruitSet</Start>
          <End>Veraison</End>
        </GenericPhase>
        <LeafDeathPhase>
          <Name>LeafDeathPhase</Name>
          <VariableReference>
            <Name>ThermalTime</Name>
            <VariableName>[Phenology].ThermalTime.Value()</VariableName>
          </VariableReference>
          <Start>Veraison</Start>
          <End>LeafFall</End>
        </LeafDeathPhase>
        <GotoPhase>
          <Name>GotoPhase</Name>
          <Start>LeafFall</Start>
          <End>Unused</End>
          <FractionComplete>0</FractionComplete>
          <PhaseNameToGoto>Dormant</PhaseNameToGoto>
        </GotoPhase>
        <OnEventFunction>
          <Name>BudBurstDOY</Name>
          <Memo>
            <Name>memo</Name>
            <MemoText><![CDATA[
A function is used to provide flowering date as days after sowing(DAS).
]]></MemoText>
          </Memo>
          <Constant>
            <Name>PreEventValue</Name>
            <FixedValue>0</FixedValue>
          </Constant>
          <VariableReference>
            <Name>PostEventValue</Name>
            <VariableName>[Clock].Today.DayOfYear</VariableName>
          </VariableReference>
          <SetEvent>BudBurst</SetEvent>
          <ReSetEvent>StartDomancy</ReSetEvent>
        </OnEventFunction>
        <OnEventFunction>
          <Name>FloweringDOY</Name>
          <Memo>
            <Name>memo</Name>
            <MemoText><![CDATA[
A function is used to provide flowering date as days after sowing(DAS).
]]></MemoText>
          </Memo>
          <Constant>
            <Name>PreEventValue</Name>
            <FixedValue>0</FixedValue>
          </Constant>
          <VariableReference>
            <Name>PostEventValue</Name>
            <VariableName>[Clock].Today.DayOfYear</VariableName>
          </VariableReference>
          <SetEvent>StartFlowering</SetEvent>
          <ReSetEvent>StartDomancy</ReSetEvent>
        </OnEventFunction>
        <OnEventFunction>
          <Name>VeraisonDOY</Name>
          <Memo>
            <Name>memo</Name>
            <MemoText><![CDATA[
A function is used to provide flowering date as days after sowing(DAS).
]]></MemoText>
          </Memo>
          <Constant>
            <Name>PreEventValue</Name>
            <FixedValue>0</FixedValue>
          </Constant>
          <VariableReference>
            <Name>PostEventValue</Name>
            <VariableName>[Clock].Today.DayOfYear</VariableName>
          </VariableReference>
          <SetEvent>Veraison</SetEvent>
          <ReSetEvent>StartDomancy</ReSetEvent>
        </OnEventFunction>
        <DaysAfterSowing>0</DaysAfterSowing>
      </Phenology>
      <Structure>
        <Name>Structure</Name>
        <PhaseLookupValue>
          <Name>MainStemPrimordiaInitiationRate</Name>
          <Constant>
            <Name>Constant</Name>
            <FixedValue>30</FixedValue>
          </Constant>
          <Start>BudBurst</Start>
          <End>Veraison</End>
        </PhaseLookupValue>
        <PhaseLookupValue>
          <Name>MainStemNodeAppearanceRate</Name>
          <Constant>
            <Name>Constant</Name>
            <FixedValue>30</FixedValue>
          </Constant>
          <Start>BudBurst</Start>
          <End>Veraison</End>
        </PhaseLookupValue>
        <Constant>
          <Name>MainStemFinalNodeNumber</Name>
          <FixedValue>24</FixedValue>
          <Units>number</Units>
        </Constant>
        <LinearInterpolationFunction>
          <Name>HeightModel</Name>
          <XYPairs>
            <Name>XYPairs</Name>
            <X>
              <double>0</double>
              <double>200</double>
              <double>1200</double>
              <double>4000</double>
            </X>
            <Y>
              <double>1800</double>
              <double>1800</double>
              <double>1800</double>
              <double>1800</double>
            </Y>
          </XYPairs>
          <XProperty>[Stem].Live.Wt</XProperty>
        </LinearInterpolationFunction>
        <MultiplyFunction>
          <Name>BranchingRate</Name>
          <LinearInterpolationFunction>
            <Name>Potential_Branching_Rate</Name>
            <XYPairs>
              <Name>XYPairs</Name>
              <X>
                <double>0</double>
                <double>7</double>
                <double>8</double>
                <double>13</double>
                <double>14</double>
                <double>34</double>
              </X>
              <Y>
                <double>0</double>
                <double>0</double>
                <double>0</double>
                <double>0</double>
                <double>0</double>
                <double>0</double>
              </Y>
            </XYPairs>
            <XProperty>[Structure].LeafTipsAppeared</XProperty>
          </LinearInterpolationFunction>
          <LinearInterpolationFunction>
            <Name>LinearInterpolationFunction</Name>
            <XYPairs>
              <Name>XYPairs</Name>
              <X>
                <double>0</double>
                <double>0.4</double>
                <double>0.55</double>
                <double>0.8</double>
                <double>1</double>
              </X>
              <Y>
                <double>1</double>
                <double>1</double>
                <double>0.45</double>
                <double>0</double>
                <double>0</double>
              </Y>
            </XYPairs>
            <XProperty>[Leaf].CoverGreen</XProperty>
          </LinearInterpolationFunction>
        </MultiplyFunction>
        <Constant>
          <Name>BranchMortality</Name>
          <FixedValue>0</FixedValue>
        </Constant>
        <Constant>
          <Name>DroughtInducedBranchMortality</Name>
          <FixedValue>0</FixedValue>
        </Constant>
        <AirTemperatureFunction>
          <Name>ThermalTime</Name>
          <XYPairs>
            <Name>XYPairs</Name>
            <X>
              <double>0</double>
              <double>30</double>
              <double>35</double>
              <double>40</double>
              <double>45</double>
            </X>
            <Y>
              <double>0</double>
              <double>30</double>
              <double>30</double>
              <double>0</double>
              <double>0</double>
            </Y>
          </XYPairs>
        </AirTemperatureFunction>
        <Initialised>false</Initialised>
        <Germinated>false</Germinated>
        <Emerged>false</Emerged>
        <CohortToInitialise>0</CohortToInitialise>
        <TipToAppear>0</TipToAppear>
        <ApexNum>0</ApexNum>
      </Structure>
      <Leaf>
        <Name>Leaf</Name>
        <VariableReference>
          <Name>ThermalTime</Name>
          <VariableName>[Structure].ThermalTime.Value()</VariableName>
        </VariableReference>
        <LeafCohort>
          <Name>InitialLeaf1</Name>
          <DeltaWaterConstrainedArea>0</DeltaWaterConstrainedArea>
          <DeltaCarbonConstrainedArea>0</DeltaCarbonConstrainedArea>
          <Rank>1</Rank>
          <Area>1000</Area>
          <MaintenanceRespiration>0</MaintenanceRespiration>
        </LeafCohort>
        <LeafCohort>
          <Name>InitialLeaf2</Name>
          <DeltaWaterConstrainedArea>0</DeltaWaterConstrainedArea>
          <DeltaCarbonConstrainedArea>0</DeltaCarbonConstrainedArea>
          <Rank>2</Rank>
          <Area>0</Area>
          <MaintenanceRespiration>0</MaintenanceRespiration>
        </LeafCohort>
        <LeafCohort>
          <Name>InitialLeaf3</Name>
          <DeltaWaterConstrainedArea>0</DeltaWaterConstrainedArea>
          <DeltaCarbonConstrainedArea>0</DeltaCarbonConstrainedArea>
          <Rank>3</Rank>
          <Area>0</Area>
          <MaintenanceRespiration>0</MaintenanceRespiration>
        </LeafCohort>
        <LeafCohortParameters>
          <Name>CohortParameters</Name>
          <LinearInterpolationFunction>
            <Name>MaxArea</Name>
            <XYPairs>
              <Name>XYPairs</Name>
              <X>
                <double>0</double>
                <double>0.15</double>
                <double>1</double>
              </X>
              <Y>
                <double>5000</double>
                <double>15000</double>
                <double>10000</double>
              </Y>
            </XYPairs>
            <XProperty>[Structure].RelativeNodeApperance</XProperty>
          </LinearInterpolationFunction>
          <LinearInterpolationFunction>
            <Name>GrowthDuration</Name>
            <XYPairs>
              <Name>XYPairs</Name>
              <X>
                <double>0</double>
                <double>0.3</double>
                <double>0.4</double>
                <double>1</double>
              </X>
              <Y>
                <double>150</double>
                <double>150</double>
                <double>150</double>
                <double>150</double>
              </Y>
            </XYPairs>
            <XProperty>[Structure].RelativeNodeApperance</XProperty>
          </LinearInterpolationFunction>
          <LinearInterpolationFunction>
            <Name>LagDuration</Name>
            <XYPairs>
              <Name>XYPairs</Name>
              <X>
                <double>0</double>
                <double>0.15</double>
                <double>0.3</double>
                <double>0.4</double>
                <double>0.73</double>
                <double>1</double>
              </X>
              <Y>
                <double>600</double>
                <double>800</double>
                <double>1000</double>
                <double>1000</double>
                <double>1000</double>
                <double>1000</double>
              </Y>
            </XYPairs>
            <XProperty>[Structure].RelativeNodeApperance</XProperty>
          </LinearInterpolationFunction>
          <LinearInterpolationFunction>
            <Name>SenescenceDuration</Name>
            <XYPairs>
              <Name>XYPairs</Name>
              <X>
                <double>0</double>
                <double>0.2</double>
                <double>1</double>
              </X>
              <Y>
                <double>400</double>
                <double>600</double>
                <double>800</double>
              </Y>
            </XYPairs>
            <XProperty>[Structure].RelativeNodeApperance</XProperty>
          </LinearInterpolationFunction>
          <Constant>
            <Name>DetachmentLagDuration</Name>
            <FixedValue>1000000</FixedValue>
            <Units>degreeDay</Units>
          </Constant>
          <Constant>
            <Name>DetachmentDuration</Name>
            <FixedValue>1000000</FixedValue>
            <Units>degreeDay</Units>
          </Constant>
          <LinearInterpolationFunction>
            <Name>SpecificLeafAreaMax</Name>
            <XYPairs>
              <Name>XYPairs</Name>
              <X>
                <double>0</double>
                <double>1</double>
              </X>
              <Y>
                <double>40000</double>
                <double>25000</double>
              </Y>
            </XYPairs>
            <XProperty>[Structure].RelativeNodeApperance</XProperty>
          </LinearInterpolationFunction>
          <Constant>
            <Name>SpecificLeafAreaMin</Name>
            <FixedValue>20000</FixedValue>
            <Units>mm2/g</Units>
          </Constant>
          <Constant>
            <Name>StructuralFraction</Name>
            <FixedValue>0.99</FixedValue>
            <Units>percentage</Units>
          </Constant>
          <Constant>
            <Name>MaximumNConc</Name>
            <FixedValue>0.05</FixedValue>
            <Units>g/g</Units>
          </Constant>
          <Constant>
            <Name>MinimumNConc</Name>
            <FixedValue>0.01</FixedValue>
            <Units>g/g</Units>
          </Constant>
          <Constant>
            <Name>InitialNConc</Name>
            <FixedValue>0.04</FixedValue>
            <Units>g/g</Units>
          </Constant>
          <Constant>
            <Name>NReallocationFactor</Name>
            <FixedValue>0</FixedValue>
            <Units>percentage</Units>
          </Constant>
          <Constant>
            <Name>NRetranslocationFactor</Name>
            <FixedValue>0</FixedValue>
            <Units>percentage</Units>
          </Constant>
          <LinearInterpolationFunction>
            <Name>ExpansionStress</Name>
            <XYPairs>
              <Name>XYPairs</Name>
              <X>
                <double>0</double>
                <double>1</double>
              </X>
              <Y>
                <double>1</double>
                <double>1</double>
              </Y>
            </XYPairs>
            <XProperty>[Grapevine].WaterSupplyDemandRatio</XProperty>
          </LinearInterpolationFunction>
          <Constant>
            <Name>CriticalNConc</Name>
            <FixedValue>0.01</FixedValue>
            <Units>g/g</Units>
          </Constant>
          <Constant>
            <Name>DMRetranslocationFactor</Name>
            <FixedValue>0</FixedValue>
            <Units>percentage</Units>
          </Constant>
          <LinearInterpolationFunction>
            <Name>ShadeInducedSenescenceRate</Name>
            <XYPairs>
              <Name>XYPairs</Name>
              <X>
                <double>0</double>
                <double>0.5</double>
                <double>0.8</double>
                <double>1</double>
              </X>
              <Y>
                <double>0</double>
                <double>0</double>
                <double>0</double>
                <double>0</double>
              </Y>
            </XYPairs>
            <XProperty>[Leaf].CohortCurrentRankCoverAbove</XProperty>
          </LinearInterpolationFunction>
          <Constant>
            <Name>NonStructuralFraction</Name>
            <FixedValue>0.2</FixedValue>
            <Units>percentage</Units>
          </Constant>
          <Constant>
            <Name>SenessingLeafRelativeSize</Name>
            <FixedValue>1</FixedValue>
            <Units>0-1</Units>
          </Constant>
          <Constant>
            <Name>DMReallocationFactor</Name>
            <FixedValue>0</FixedValue>
            <Units>percentage</Units>
          </Constant>
          <Constant>
            <Name>LeafSizeShapeParameter</Name>
            <FixedValue>0.01</FixedValue>
            <Units>parameter controls the logistic growth of the leaf in growth stage</Units>
          </Constant>
          <Constant>
            <Name>MaintenanceRespirationFunction</Name>
            <FixedValue>0</FixedValue>
            <Units>g/g</Units>
          </Constant>
          <Constant>
            <Name>DroughtInducedLagAcceleration</Name>
            <FixedValue>1</FixedValue>
          </Constant>
          <Constant>
            <Name>DroughtInducedSenAcceleration</Name>
            <FixedValue>1</FixedValue>
          </Constant>
          <Constant>
            <Name>CellDivisionStress</Name>
            <FixedValue>1</FixedValue>
            <Units>0-1</Units>
          </Constant>
        </LeafCohortParameters>
        <RUEModel>
          <Name>Photosynthesis</Name>
          <Constant>
            <Name>RUE</Name>
            <FixedValue>0.8</FixedValue>
            <Units>g/MJ</Units>
          </Constant>
          <RUECO2Function>
            <Name>FCO2</Name>
            <PhotosyntheticPathway>C3</PhotosyntheticPathway>
          </RUECO2Function>
          <LinearInterpolationFunction>
            <Name>FN</Name>
            <XYPairs>
              <Name>XYPairs</Name>
              <X>
                <double>0</double>
                <double>1</double>
                <double>1.5</double>
              </X>
              <Y>
                <double>0</double>
                <double>1</double>
                <double>1</double>
              </Y>
            </XYPairs>
            <XProperty>[Leaf].Fn</XProperty>
          </LinearInterpolationFunction>
          <WeightedTemperatureFunction>
            <Name>FT</Name>
            <XYPairs>
              <Name>XYPairs</Name>
              <X>
                <double>5</double>
                <double>20</double>
                <double>30</double>
                <double>45</double>
              </X>
              <Y>
                <double>0</double>
                <double>1</double>
                <double>1</double>
                <double>0</double>
              </Y>
            </XYPairs>
            <MaximumTemperatureWeighting>0.75</MaximumTemperatureWeighting>
          </WeightedTemperatureFunction>
          <LinearInterpolationFunction>
            <Name>FW</Name>
            <XYPairs>
              <Name>XYPairs</Name>
              <X>
                <double>0</double>
                <double>1</double>
                <double>1.5</double>
              </X>
              <Y>
                <double>0</double>
                <double>1</double>
                <double>1</double>
              </Y>
            </XYPairs>
            <XProperty>[Leaf].Fw</XProperty>
          </LinearInterpolationFunction>
          <LinearInterpolationFunction>
            <Name>FVPD</Name>
            <XYPairs>
              <Name>XYPairs</Name>
              <X>
                <double>0</double>
                <double>10</double>
                <double>50</double>
              </X>
              <Y>
                <double>1</double>
                <double>1</double>
                <double>1</double>
              </Y>
            </XYPairs>
            <XProperty>[Leaf].Photosynthesis.VPD</XProperty>
          </LinearInterpolationFunction>
          <VariableReference>
            <Name>RadnInt</Name>
            <VariableName>[Leaf].RadIntTot</VariableName>
          </VariableReference>
        </RUEModel>
        <MinimumFunction>
          <Name>FRGRFunction</Name>
          <VariableReference>
            <Name>RUE_FT</Name>
            <VariableName>[Leaf].Photosynthesis.FT.Value()</VariableName>
          </VariableReference>
          <MinimumFunction>
            <Name>Others</Name>
            <VariableReference>
              <Name>RUE_FN</Name>
              <VariableName>[Leaf].Photosynthesis.FN.Value()</VariableName>
            </VariableReference>
            <VariableReference>
              <Name>RUE_FVPD</Name>
              <VariableName>[Leaf].Photosynthesis.FVPD.Value()</VariableName>
            </VariableReference>
          </MinimumFunction>
        </MinimumFunction>
        <MultiplyFunction>
          <Name>ExtinctionCoeff</Name>
          <Constant>
            <Name>Constant</Name>
            <FixedValue>0.5</FixedValue>
          </Constant>
        </MultiplyFunction>
        <CompositeBiomass>
          <Name>Live</Name>
          <Propertys>
            <string>[Leaf].CohortLive</string>
          </Propertys>
        </CompositeBiomass>
        <CompositeBiomass>
          <Name>Dead</Name>
          <Propertys>
            <string>[Leaf].CohortDead</string>
          </Propertys>
        </CompositeBiomass>
        <CompositeBiomass>
          <Name>Total</Name>
          <Propertys>
            <string>[Leaf].Live</string>
            <string>[Leaf].Dead</string>
          </Propertys>
        </CompositeBiomass>
        <ArrayBiomass>
          <Name>CohortArrayLive</Name>
          <Propertys>
            <string>[Leaf].Live</string>
          </Propertys>
          <ArraySize>[Leaf].MaxNodeNo</ArraySize>
        </ArrayBiomass>
        <ArrayBiomass>
          <Name>CohortArrayDead</Name>
          <Propertys>
            <string>[Leaf].Dead</string>
          </Propertys>
          <ArraySize>[Leaf].MaxNodeNo</ArraySize>
        </ArrayBiomass>
        <BiomassRemoval>
          <Name>BiomassRemovalDefaults</Name>
          <OrganBiomassRemovalType>
            <Name>Harvest</Name>
            <FractionLiveToRemove>0.2</FractionLiveToRemove>
            <FractionDeadToRemove>0</FractionDeadToRemove>
            <FractionLiveToResidue>0</FractionLiveToResidue>
            <FractionDeadToResidue>1</FractionDeadToResidue>
          </OrganBiomassRemovalType>
          <OrganBiomassRemovalType>
            <Name>Cut</Name>
            <FractionLiveToRemove>0</FractionLiveToRemove>
            <FractionDeadToRemove>0</FractionDeadToRemove>
            <FractionLiveToResidue>0.2</FractionLiveToResidue>
            <FractionDeadToResidue>0.3</FractionDeadToResidue>
          </OrganBiomassRemovalType>
          <OrganBiomassRemovalType>
            <Name>Prune</Name>
            <FractionLiveToRemove>0</FractionLiveToRemove>
            <FractionDeadToRemove>0</FractionDeadToRemove>
            <FractionLiveToResidue>0.5</FractionLiveToResidue>
            <FractionDeadToResidue>0.5</FractionDeadToResidue>
          </OrganBiomassRemovalType>
          <OrganBiomassRemovalType>
            <Name>Graze</Name>
            <FractionLiveToRemove>0.6</FractionLiveToRemove>
            <FractionDeadToRemove>0</FractionDeadToRemove>
            <FractionLiveToResidue>0.1</FractionLiveToResidue>
            <FractionDeadToResidue>0</FractionDeadToResidue>
          </OrganBiomassRemovalType>
        </BiomassRemoval>
        <Constant>
          <Name>StructuralFraction</Name>
          <FixedValue>0.99</FixedValue>
          <Units>percentage</Units>
        </Constant>
        <PhaseLookupValue>
          <Name>FrostFraction</Name>
          <LinearInterpolationFunction>
            <Name>LinearInterpolationFunction</Name>
            <XYPairs>
              <Name>XYPairs</Name>
              <X>
                <double>4</double>
                <double>3</double>
              </X>
              <Y>
                <double>0</double>
                <double>0</double>
              </Y>
            </XYPairs>
            <XProperty>[Weather].MinT</XProperty>
          </LinearInterpolationFunction>
          <Start>Veraison</Start>
          <End>LeafFall</End>
        </PhaseLookupValue>
        <Constant>
          <Name>DMConversionEfficiencyFunction</Name>
          <FixedValue>1</FixedValue>
        </Constant>
        <GrowthRespiration>0</GrowthRespiration>
        <MaintenanceRespiration>0</MaintenanceRespiration>
        <CurrentExpandingLeaf>34</CurrentExpandingLeaf>
        <StartFractionExpanded>0.83819041077407885</StartFractionExpanded>
        <FractionNextleafExpanded>0.92664093062319453</FractionNextleafExpanded>
        <DeadNodesYesterday>0</DeadNodesYesterday>
        <MaxCover>1</MaxCover>
        <Albedo>0.25</Albedo>
        <Gsmax>0.01</Gsmax>
        <R50>200</R50>
        <FRGR>0</FRGR>
        <PotentialEP>0</PotentialEP>
        <MicroClimatePresent>true</MicroClimatePresent>
        <KDead>0.03</KDead>
        <MaximumMainStemLeafNumber>24</MaximumMainStemLeafNumber>
        <DMConversionEfficiency>0</DMConversionEfficiency>
        <TipsAtEmergence>0</TipsAtEmergence>
        <CohortsAtInitialisation>0</CohortsAtInitialisation>
        <FractionDied>0</FractionDied>
      </Leaf>
      <Root>
        <Name>Root</Name>
        <CompositeBiomass>
          <Name>Live</Name>
          <Propertys>
            <string>[Root].LayerLive</string>
          </Propertys>
        </CompositeBiomass>
        <CompositeBiomass>
          <Name>Dead</Name>
          <Propertys>
            <string>[Root].LayerDead</string>
          </Propertys>
        </CompositeBiomass>
        <PhaseBasedSwitch>
          <Name>NitrogenDemandSwitch</Name>
          <Start>BudBurst</Start>
          <End>LeafFall</End>
        </PhaseBasedSwitch>
        <Constant>
          <Name>MinimumNConc</Name>
          <FixedValue>0.01</FixedValue>
          <Units>g/g</Units>
        </Constant>
        <Constant>
          <Name>MaximumNConc</Name>
          <FixedValue>0.01</FixedValue>
          <Units>g/g</Units>
        </Constant>
        <Constant>
          <Name>MaximumRootDepth</Name>
          <FixedValue>1000000</FixedValue>
          <Units>mm</Units>
        </Constant>
        <LinearInterpolationFunction>
          <Name>MaxDailyNUptake</Name>
          <XYPairs>
            <Name>XYPairs</Name>
            <X>
              <double>0</double>
              <double>0.02</double>
            </X>
            <Y>
              <double>0</double>
              <double>6</double>
            </Y>
          </XYPairs>
          <XProperty>[Root].Length</XProperty>
        </LinearInterpolationFunction>
        <LinearInterpolationFunction>
          <Name>KLModifier</Name>
          <XYPairs>
            <Name>XYPairs</Name>
            <X>
              <double>0</double>
              <double>3</double>
            </X>
            <Y>
              <double>1</double>
              <double>1</double>
            </Y>
          </XYPairs>
          <XProperty>[Leaf].LAI</XProperty>
        </LinearInterpolationFunction>
        <LinearInterpolationFunction>
          <Name>SenescenceRate</Name>
          <XYPairs>
            <Name>XYPairs</Name>
            <X>
              <double>0</double>
              <double>1</double>
            </X>
            <Y>
              <double>0</double>
              <double>0.1</double>
            </Y>
          </XYPairs>
          <XProperty>[Leaf].FractionDied</XProperty>
        </LinearInterpolationFunction>
        <BiomassRemoval>
          <Name>BiomassRemovalDefaults</Name>
          <OrganBiomassRemovalType>
            <Name>Harvest</Name>
            <FractionLiveToRemove>0</FractionLiveToRemove>
            <FractionDeadToRemove>0</FractionDeadToRemove>
            <FractionLiveToResidue>0.2</FractionLiveToResidue>
            <FractionDeadToResidue>0</FractionDeadToResidue>
          </OrganBiomassRemovalType>
          <OrganBiomassRemovalType>
            <Name>Cut</Name>
            <FractionLiveToRemove>0</FractionLiveToRemove>
            <FractionDeadToRemove>0</FractionDeadToRemove>
            <FractionLiveToResidue>0.3</FractionLiveToResidue>
            <FractionDeadToResidue>0</FractionDeadToResidue>
          </OrganBiomassRemovalType>
          <OrganBiomassRemovalType>
            <Name>Prune</Name>
            <FractionLiveToRemove>0</FractionLiveToRemove>
            <FractionDeadToRemove>0</FractionDeadToRemove>
            <FractionLiveToResidue>0.1</FractionLiveToResidue>
            <FractionDeadToResidue>0</FractionDeadToResidue>
          </OrganBiomassRemovalType>
          <OrganBiomassRemovalType>
            <Name>Graze</Name>
            <FractionLiveToRemove>0</FractionLiveToRemove>
            <FractionDeadToRemove>0</FractionDeadToRemove>
            <FractionLiveToResidue>0.15</FractionLiveToResidue>
            <FractionDeadToResidue>0</FractionDeadToResidue>
          </OrganBiomassRemovalType>
        </BiomassRemoval>
        <LinearInterpolationFunction>
          <Name>KNO3</Name>
          <XYPairs>
            <Name>XYPairs</Name>
            <X>
              <double>0</double>
              <double>0.003</double>
            </X>
            <Y>
              <double>0.02</double>
              <double>0.02</double>
            </Y>
          </XYPairs>
          <XProperty>[Root].RootLengthDenisty</XProperty>
        </LinearInterpolationFunction>
        <LinearInterpolationFunction>
          <Name>KNH4</Name>
          <XYPairs>
            <Name>XYPairs</Name>
            <X>
              <double>0</double>
              <double>0.003</double>
            </X>
            <Y>
              <double>0</double>
              <double>0</double>
            </Y>
          </XYPairs>
          <XProperty>[Root].RootLengthDenisty</XProperty>
        </LinearInterpolationFunction>
        <LinearInterpolationFunction>
          <Name>NUptakeSWFactor</Name>
          <XYPairs>
            <Name>XYPairs</Name>
            <X>
              <double>0</double>
              <double>1</double>
            </X>
            <Y>
              <double>0</double>
              <double>1</double>
            </Y>
          </XYPairs>
          <XProperty>[Root].RWC</XProperty>
        </LinearInterpolationFunction>
        <Constant>
          <Name>InitialDM</Name>
          <FixedValue>5</FixedValue>
          <Units>g/plant</Units>
        </Constant>
        <Constant>
          <Name>SpecificRootLength</Name>
          <FixedValue>40</FixedValue>
          <Units>m/g</Units>
        </Constant>
        <Constant>
          <Name>RootFrontVelocity</Name>
          <FixedValue>10</FixedValue>
          <Units>mm/d</Units>
        </Constant>
        <Constant>
          <Name>PartitionFraction</Name>
          <FixedValue>0.2</FixedValue>
          <Units>percentage</Units>
        </Constant>
        <GrowthRespiration>0</GrowthRespiration>
        <MaintenanceRespiration>0</MaintenanceRespiration>
        <ZoneNamesToGrowRootsIn />
        <ZoneRootDepths />
        <ZoneInitialDM />
      </Root>
      <GenericOrgan>
        <Name>Stem</Name>
        <Constant>
          <Name>NReallocationFactor</Name>
          <FixedValue>0</FixedValue>
          <Units>percentage</Units>
        </Constant>
        <Constant>
          <Name>NRetranslocationFactor</Name>
          <FixedValue>0.05</FixedValue>
          <Units>percentage</Units>
        </Constant>
        <PhaseBasedSwitch>
          <Name>NitrogenDemandSwitch</Name>
          <Start>BudBurst</Start>
          <End>LeafFall</End>
        </PhaseBasedSwitch>
        <Constant>
          <Name>DMRetranslocationFactor</Name>
          <FixedValue>0</FixedValue>
          <Units>percentage</Units>
        </Constant>
        <InternodeDemandFunction>
          <Name>DMDemandFunction</Name>
          <Constant>
            <Name>InterNodeWt</Name>
            <FixedValue>0.2</FixedValue>
          </Constant>
        </InternodeDemandFunction>
        <LinearInterpolationFunction>
          <Name>MaximumNConc</Name>
          <XYPairs>
            <Name>XYPairs</Name>
            <X>
              <double>3</double>
              <double>4</double>
              <double>5.3</double>
            </X>
            <Y>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.025</double>
            </Y>
          </XYPairs>
          <XProperty>[Phenology].Stage</XProperty>
        </LinearInterpolationFunction>
        <Constant>
          <Name>MinimumNConc</Name>
          <FixedValue>0.006</FixedValue>
          <Units>g/g</Units>
        </Constant>
        <Biomass>
          <Name>Live</Name>
        </Biomass>
        <Biomass>
          <Name>Dead</Name>
        </Biomass>
        <BiomassRemoval>
          <Name>BiomassRemovalDefaults</Name>
          <OrganBiomassRemovalType>
            <Name>Harvest</Name>
            <FractionLiveToRemove>0.5</FractionLiveToRemove>
            <FractionDeadToRemove>0</FractionDeadToRemove>
            <FractionLiveToResidue>0.1</FractionLiveToResidue>
            <FractionDeadToResidue>0</FractionDeadToResidue>
          </OrganBiomassRemovalType>
          <OrganBiomassRemovalType>
            <Name>Cut</Name>
            <FractionLiveToRemove>0.8</FractionLiveToRemove>
            <FractionDeadToRemove>0</FractionDeadToRemove>
            <FractionLiveToResidue>0</FractionLiveToResidue>
            <FractionDeadToResidue>0</FractionDeadToResidue>
          </OrganBiomassRemovalType>
          <OrganBiomassRemovalType>
            <Name>Prune</Name>
            <FractionLiveToRemove>0</FractionLiveToRemove>
            <FractionDeadToRemove>0</FractionDeadToRemove>
            <FractionLiveToResidue>0.6</FractionLiveToResidue>
            <FractionDeadToResidue>0</FractionDeadToResidue>
          </OrganBiomassRemovalType>
          <OrganBiomassRemovalType>
            <Name>Graze</Name>
            <FractionLiveToRemove>0.6</FractionLiveToRemove>
            <FractionDeadToRemove>0</FractionDeadToRemove>
            <FractionLiveToResidue>0.2</FractionLiveToResidue>
            <FractionDeadToResidue>0</FractionDeadToResidue>
          </OrganBiomassRemovalType>
        </BiomassRemoval>
        <Constant>
          <Name>InitialWtFunction</Name>
          <FixedValue>0</FixedValue>
          <Units>g/m^2</Units>
        </Constant>
        <Constant>
          <Name>StructuralFraction</Name>
          <FixedValue>1</FixedValue>
          <Units>g/g</Units>
        </Constant>
        <Constant>
          <Name>DetachmentRateFunction</Name>
          <FixedValue>0</FixedValue>
          <Units>1/d</Units>
        </Constant>
        <Constant>
          <Name>SenescenceRate</Name>
          <FixedValue>0</FixedValue>
          <Units>/d</Units>
        </Constant>
        <Constant>
          <Name>MaintenanceRespirationFunction</Name>
          <FixedValue>0</FixedValue>
          <Units>0-1</Units>
        </Constant>
        <Constant>
          <Name>DMConversionEfficiency</Name>
          <FixedValue>1</FixedValue>
          <Units>0-1</Units>
        </Constant>
      </GenericOrgan>
      <GenericOrgan>
        <Name>Cordon</Name>
        <Constant>
          <Name>NReallocationFactor</Name>
          <FixedValue>0</FixedValue>
          <Units>percentage</Units>
        </Constant>
        <Constant>
          <Name>NRetranslocationFactor</Name>
          <FixedValue>0.05</FixedValue>
          <Units>percentage</Units>
        </Constant>
        <PhaseBasedSwitch>
          <Name>NitrogenDemandSwitch</Name>
          <Start>BudBurst</Start>
          <End>LeafFall</End>
        </PhaseBasedSwitch>
        <Constant>
          <Name>DMRetranslocationFactor</Name>
          <FixedValue>0</FixedValue>
          <Units>percentage</Units>
        </Constant>
        <LinearInterpolationFunction>
          <Name>MaximumNConc</Name>
          <XYPairs>
            <Name>XYPairs</Name>
            <X>
              <double>3</double>
              <double>4</double>
              <double>5.3</double>
            </X>
            <Y>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.025</double>
            </Y>
          </XYPairs>
          <XProperty>[Phenology].Stage</XProperty>
        </LinearInterpolationFunction>
        <Constant>
          <Name>MinimumNConc</Name>
          <FixedValue>0.006</FixedValue>
          <Units>g/g</Units>
        </Constant>
        <Biomass>
          <Name>Live</Name>
        </Biomass>
        <Biomass>
          <Name>Dead</Name>
        </Biomass>
        <BiomassRemoval>
          <Name>BiomassRemovalDefaults</Name>
          <OrganBiomassRemovalType>
            <Name>Harvest</Name>
            <FractionLiveToRemove>0</FractionLiveToRemove>
            <FractionDeadToRemove>0</FractionDeadToRemove>
            <FractionLiveToResidue>0</FractionLiveToResidue>
            <FractionDeadToResidue>0</FractionDeadToResidue>
          </OrganBiomassRemovalType>
          <OrganBiomassRemovalType>
            <Name>Cut</Name>
            <FractionLiveToRemove>0</FractionLiveToRemove>
            <FractionDeadToRemove>0</FractionDeadToRemove>
            <FractionLiveToResidue>0</FractionLiveToResidue>
            <FractionDeadToResidue>0</FractionDeadToResidue>
          </OrganBiomassRemovalType>
          <OrganBiomassRemovalType>
            <Name>Prune</Name>
            <FractionLiveToRemove>0</FractionLiveToRemove>
            <FractionDeadToRemove>0</FractionDeadToRemove>
            <FractionLiveToResidue>0</FractionLiveToResidue>
            <FractionDeadToResidue>0</FractionDeadToResidue>
          </OrganBiomassRemovalType>
          <OrganBiomassRemovalType>
            <Name>Graze</Name>
            <FractionLiveToRemove>0</FractionLiveToRemove>
            <FractionDeadToRemove>0</FractionDeadToRemove>
            <FractionLiveToResidue>0</FractionLiveToResidue>
            <FractionDeadToResidue>0</FractionDeadToResidue>
          </OrganBiomassRemovalType>
        </BiomassRemoval>
        <Constant>
          <Name>InitialWtFunction</Name>
          <FixedValue>200</FixedValue>
          <Units>g/m^2</Units>
        </Constant>
        <Constant>
          <Name>StructuralFraction</Name>
          <FixedValue>1</FixedValue>
          <Units>percentage</Units>
        </Constant>
        <Constant>
          <Name>DetachmentRateFunction</Name>
          <FixedValue>0</FixedValue>
          <Units>/d</Units>
        </Constant>
        <Constant>
          <Name>SenescenceRate</Name>
          <FixedValue>0</FixedValue>
          <Units>/d</Units>
        </Constant>
        <Constant>
          <Name>MaintenanceRespirationFunction</Name>
          <FixedValue>0.001</FixedValue>
          <Units>0-1</Units>
        </Constant>
        <Constant>
          <Name>DMConversionEfficiency</Name>
          <FixedValue>1</FixedValue>
          <Units>0-1</Units>
        </Constant>
        <PartitionFractionDemandFunction>
          <Name>DMDemandFunction</Name>
          <Constant>
            <Name>PartitionFraction</Name>
            <FixedValue>0.01</FixedValue>
          </Constant>
        </PartitionFractionDemandFunction>
      </GenericOrgan>
      <GenericOrgan>
        <Name>Trunk</Name>
        <Constant>
          <Name>NReallocationFactor</Name>
          <FixedValue>0</FixedValue>
        </Constant>
        <Constant>
          <Name>NRetranslocationFactor</Name>
          <FixedValue>0.05</FixedValue>
        </Constant>
        <PhaseBasedSwitch>
          <Name>NitrogenDemandSwitch</Name>
          <Start>BudBurst</Start>
          <End>LeafFall</End>
        </PhaseBasedSwitch>
        <Constant>
          <Name>DMRetranslocationFactor</Name>
          <FixedValue>0</FixedValue>
        </Constant>
        <LinearInterpolationFunction>
          <Name>MaximumNConc</Name>
          <XYPairs>
            <Name>XYPairs</Name>
            <X>
              <double>3</double>
              <double>4</double>
              <double>5.3</double>
            </X>
            <Y>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.025</double>
            </Y>
          </XYPairs>
          <XProperty>[Phenology].Stage</XProperty>
        </LinearInterpolationFunction>
        <Constant>
          <Name>MinimumNConc</Name>
          <FixedValue>0.006</FixedValue>
        </Constant>
        <Biomass>
          <Name>Live</Name>
        </Biomass>
        <Biomass>
          <Name>Dead</Name>
        </Biomass>
        <BiomassRemoval>
          <Name>BiomassRemovalDefaults</Name>
          <OrganBiomassRemovalType>
            <Name>Harvest</Name>
            <FractionLiveToRemove>0</FractionLiveToRemove>
            <FractionDeadToRemove>0</FractionDeadToRemove>
            <FractionLiveToResidue>0</FractionLiveToResidue>
            <FractionDeadToResidue>0</FractionDeadToResidue>
          </OrganBiomassRemovalType>
          <OrganBiomassRemovalType>
            <Name>Cut</Name>
            <FractionLiveToRemove>0</FractionLiveToRemove>
            <FractionDeadToRemove>0</FractionDeadToRemove>
            <FractionLiveToResidue>0</FractionLiveToResidue>
            <FractionDeadToResidue>0</FractionDeadToResidue>
          </OrganBiomassRemovalType>
          <OrganBiomassRemovalType>
            <Name>Prune</Name>
            <FractionLiveToRemove>0</FractionLiveToRemove>
            <FractionDeadToRemove>0</FractionDeadToRemove>
            <FractionLiveToResidue>0</FractionLiveToResidue>
            <FractionDeadToResidue>0</FractionDeadToResidue>
          </OrganBiomassRemovalType>
          <OrganBiomassRemovalType>
            <Name>Graze</Name>
            <FractionLiveToRemove>0</FractionLiveToRemove>
            <FractionDeadToRemove>0</FractionDeadToRemove>
            <FractionLiveToResidue>0</FractionLiveToResidue>
            <FractionDeadToResidue>0</FractionDeadToResidue>
          </OrganBiomassRemovalType>
        </BiomassRemoval>
        <Constant>
          <Name>InitialWtFunction</Name>
          <FixedValue>2000</FixedValue>
          <Units>g/m^2</Units>
        </Constant>
        <Constant>
          <Name>StructuralFraction</Name>
          <FixedValue>1</FixedValue>
          <Units>g/g</Units>
        </Constant>
        <Constant>
          <Name>DetachmentRateFunction</Name>
          <FixedValue>0</FixedValue>
          <Units>/d</Units>
        </Constant>
        <Constant>
          <Name>SenescenceRate</Name>
          <FixedValue>0</FixedValue>
          <Units>/d</Units>
        </Constant>
        <Constant>
          <Name>MaintenanceRespirationFunction</Name>
          <FixedValue>0.001</FixedValue>
          <Units>0-1</Units>
        </Constant>
        <Constant>
          <Name>DMConversionEfficiency</Name>
          <FixedValue>1</FixedValue>
          <Units>0-1</Units>
        </Constant>
        <PartitionFractionDemandFunction>
          <Name>DMDemandFunction</Name>
          <Constant>
            <Name>PartitionFraction</Name>
            <FixedValue>0.05</FixedValue>
          </Constant>
        </PartitionFractionDemandFunction>
      </GenericOrgan>
      <ReproductiveOrgan>
        <Name>Berry</Name>
        <Biomass>
          <Name>Live</Name>
        </Biomass>
        <Biomass>
          <Name>Dead</Name>
        </Biomass>
        <Constant>
          <Name>MaxNConcDailyGrowth</Name>
          <FixedValue>0.01</FixedValue>
          <Units>g/g</Units>
        </Constant>
        <Constant>
          <Name>NFillingRate</Name>
          <FixedValue>0</FixedValue>
        </Constant>
        <Constant>
          <Name>MinimumNConc</Name>
          <FixedValue>0</FixedValue>
        </Constant>
        <Constant>
          <Name>MaximumNConc</Name>
          <FixedValue>0.0001</FixedValue>
        </Constant>
        <AccumulateFunction>
          <Name>ThermalTimeAfterVeraison</Name>
          <VariableReference>
            <Name>ThermalTime</Name>
            <VariableName>[Phenology].ThermalTime.Value()</VariableName>
          </VariableReference>
          <StartStageName>Veraison</StartStageName>
          <EndStageName>LeafFall</EndStageName>
          <ResetStageName>Veraison</ResetStageName>
        </AccumulateFunction>
        <LinearInterpolationFunction>
          <Name>ReadyForHarvest</Name>
          <XYPairs>
            <Name>XYPairs</Name>
            <X>
              <double>0</double>
              <double>200</double>
              <double>201</double>
            </X>
            <Y>
              <double>0</double>
              <double>0</double>
              <double>1</double>
            </Y>
          </XYPairs>
          <XProperty>[Berry].ThermalTimeAfterVeraison.Value()</XProperty>
        </LinearInterpolationFunction>
        <AccumulateFunction>
          <Name>ThermalTimeAfterFlowering</Name>
          <VariableReference>
            <Name>ThermalTime</Name>
            <VariableName>[Phenology].ThermalTime.Value()</VariableName>
          </VariableReference>
          <StartStageName>FruitSet</StartStageName>
          <EndStageName>LeafFall</EndStageName>
          <ResetStageName>FruitSet</ResetStageName>
        </AccumulateFunction>
        <ExponentialFunction>
          <Name>SolubleSolidsConc</Name>
          <VariableReference>
            <Name>ThermalTime</Name>
            <VariableName>[Berry].DaysAfterVeraison.Value()</VariableName>
          </VariableReference>
          <A>24</A>
          <B>-15.6582</B>
          <C>-0.040501</C>
        </ExponentialFunction>
        <MultiplyFunction>
          <Name>NumberFunction</Name>
          <VariableReference>
            <Name>Shoots</Name>
            <VariableName>[Structure].MainStemPopn</VariableName>
          </VariableReference>
          <OnEventFunction>
            <Name>BunchesPerShoot</Name>
            <Constant>
              <Name>PreEventValue</Name>
              <FixedValue>0</FixedValue>
            </Constant>
            <LinearInterpolationFunction>
              <Name>PostEventValue</Name>
              <XYPairs>
                <Name>XYPairs</Name>
                <X>
                  <double>0</double>
                  <double>40</double>
                </X>
                <Y>
                  <double>0</double>
                  <double>5</double>
                </Y>
              </XYPairs>
              <XProperty>[Berry].MeanFloweringTempY0.Value()</XProperty>
            </LinearInterpolationFunction>
            <SetEvent>BudBurst</SetEvent>
            <ReSetEvent>EndDormancy</ReSetEvent>
          </OnEventFunction>
          <AddFunction>
            <Name>PotentialBerriesPerBunch</Name>
            <Constant>
              <Name>MinNum</Name>
              <FixedValue>66</FixedValue>
            </Constant>
            <SigmoidFunction>
              <Name>BerriesPerBunch</Name>
              <VariableReference>
                <Name>XVariable</Name>
                <VariableName>[Berry].MeanFloweringTemp.Value()</VariableName>
              </VariableReference>
              <Xmax>44</Xmax>
              <Xo>16.3</Xo>
              <b>0.7</b>
            </SigmoidFunction>
          </AddFunction>
        </MultiplyFunction>
        <OnEventFunction>
          <Name>MeanFloweringTempY0</Name>
          <Constant>
            <Name>PreEventValue</Name>
            <FixedValue>13</FixedValue>
          </Constant>
          <LinearInterpolationFunction>
            <Name>PostEventValue</Name>
            <XYPairs>
              <Name>XYPairs</Name>
              <X>
                <double>0</double>
                <double>40</double>
              </X>
              <Y>
                <double>0</double>
                <double>40</double>
              </Y>
            </XYPairs>
            <XProperty>[Berry].MeanFloweringTemp.Value()</XProperty>
          </LinearInterpolationFunction>
          <SetEvent>FruitSet</SetEvent>
          <ReSetEvent>StartFlowering</ReSetEvent>
        </OnEventFunction>
        <DivideFunction>
          <Name>MeanFloweringTemp</Name>
          <AccumulateFunction>
            <Name>Temperature</Name>
            <AirTemperatureFunction>
              <Name>AirTemperatureFunction</Name>
              <XYPairs>
                <Name>XYPairs</Name>
                <X>
                  <double>0</double>
                  <double>40</double>
                </X>
                <Y>
                  <double>0</double>
                  <double>40</double>
                </Y>
              </XYPairs>
            </AirTemperatureFunction>
            <StartStageName>StartFlowering</StartStageName>
            <EndStageName>FruitSet</EndStageName>
            <ResetStageName>StartFlowering</ResetStageName>
          </AccumulateFunction>
          <AccumulateFunction>
            <Name>Time</Name>
            <Constant>
              <Name>Days</Name>
              <FixedValue>1</FixedValue>
              <Units>days/day</Units>
            </Constant>
            <StartStageName>StartFlowering</StartStageName>
            <EndStageName>FruitSet</EndStageName>
            <ResetStageName>StartFlowering</ResetStageName>
          </AccumulateFunction>
        </DivideFunction>
        <BerryFillingRateFunction>
          <Name>DMDemandFunction</Name>
          <VariableReference>
            <Name>TT</Name>
            <VariableName>[Structure].ThermalTime.Value()</VariableName>
          </VariableReference>
          <FirstPhase>BerryDevelopment</FirstPhase>
          <SecondPhase>LeafDeathPhase</SecondPhase>
          <Wo1>0.0001</Wo1>
          <Wf1>0.199</Wf1>
          <Mu1>0.007</Mu1>
          <Wo2>0.0001</Wo2>
          <Wf2>0.3</Wf2>
          <Mu2>0.011</Mu2>
        </BerryFillingRateFunction>
        <BiomassRemoval>
          <Name>BiomassRemovalDefaults</Name>
          <OrganBiomassRemovalType>
            <Name>Harvest</Name>
            <FractionLiveToRemove>1</FractionLiveToRemove>
            <FractionDeadToRemove>0</FractionDeadToRemove>
            <FractionLiveToResidue>0</FractionLiveToResidue>
            <FractionDeadToResidue>0</FractionDeadToResidue>
          </OrganBiomassRemovalType>
          <OrganBiomassRemovalType>
            <Name>Cut</Name>
            <FractionLiveToRemove>1</FractionLiveToRemove>
            <FractionDeadToRemove>0</FractionDeadToRemove>
            <FractionLiveToResidue>0</FractionLiveToResidue>
            <FractionDeadToResidue>0</FractionDeadToResidue>
          </OrganBiomassRemovalType>
          <OrganBiomassRemovalType>
            <Name>Prune</Name>
            <FractionLiveToRemove>0</FractionLiveToRemove>
            <FractionDeadToRemove>0</FractionDeadToRemove>
            <FractionLiveToResidue>1</FractionLiveToResidue>
            <FractionDeadToResidue>0</FractionDeadToResidue>
          </OrganBiomassRemovalType>
          <OrganBiomassRemovalType>
            <Name>Graze</Name>
            <FractionLiveToRemove>0</FractionLiveToRemove>
            <FractionDeadToRemove>0</FractionDeadToRemove>
            <FractionLiveToResidue>0</FractionLiveToResidue>
            <FractionDeadToResidue>0</FractionDeadToResidue>
          </OrganBiomassRemovalType>
          <OrganBiomassRemovalType>
            <Name>Thin</Name>
            <FractionLiveToRemove>0</FractionLiveToRemove>
            <FractionDeadToRemove>0</FractionDeadToRemove>
            <FractionLiveToResidue>0</FractionLiveToResidue>
            <FractionDeadToResidue>0</FractionDeadToResidue>
          </OrganBiomassRemovalType>
        </BiomassRemoval>
        <Constant>
          <Name>MaximumPotentialGrainSize</Name>
          <FixedValue>2</FixedValue>
          <Units>g</Units>
        </Constant>
        <SubtractFunction>
          <Name>WaterContent</Name>
          <Constant>
            <Name>Constant</Name>
            <FixedValue>0.903</FixedValue>
          </Constant>
          <PhaseLookupValue>
            <Name>PhaseLookupValue</Name>
            <LinearInterpolationFunction>
              <Name>LinearInterpolationFunction</Name>
              <XYPairs>
                <Name>XYPairs</Name>
                <X>
                  <double>0</double>
                  <double>100</double>
                  <double>200</double>
                  <double>300</double>
                  <double>400</double>
                  <double>600</double>
                </X>
                <Y>
                  <double>0</double>
                  <double>0.01</double>
                  <double>0.02</double>
                  <double>0.04</double>
                  <double>0.15</double>
                  <double>0.15</double>
                </Y>
              </XYPairs>
              <XProperty>[Berry].ThermalTimeAfterVeraison.Value()</XProperty>
            </LinearInterpolationFunction>
            <Start>Veraison</Start>
            <End>LeafFall</End>
          </PhaseLookupValue>
        </SubtractFunction>
        <GrowthRespiration>0</GrowthRespiration>
        <MaintenanceRespiration>0</MaintenanceRespiration>
        <RipeStage>Ripe</RipeStage>
      </ReproductiveOrgan>
      <OrganArbitrator>
        <Name>Arbitrator</Name>
        <RelativeAllocation>
          <Name>NArbitrator</Name>
        </RelativeAllocation>
        <RelativeAllocation>
          <Name>DMArbitrator</Name>
        </RelativeAllocation>
      </OrganArbitrator>
      <CropType>Grapevine</CropType>
      <SowingDate>0001-01-01T00:00:00</SowingDate>
    </Plant>
    <Report>
      <Name>Report</Name>
      <ExperimentFactorNames />
      <ExperimentFactorValues />
      <VariableNames>
        <string>Name as Zone</string>
        <string>[Clock].Today</string>
        <string>[Clock].Today.Year</string>
        <string>[Grapevine].Phenology.Stage</string>
        <string>[Grapevine].Phenology.BudBurstDOY.Value()</string>
        <string>[Grapevine].Phenology.FloweringDOY.Value()</string>
        <string>[Grapevine].Phenology.VeraisonDOY.Value()</string>
        <string>[Grapevine].Phenology.CurrentStageName</string>
        <string>[Grapevine].Structure.LeafTipsAppeared</string>
        <string>[Grapevine].Structure.PlantTotalNodeNo</string>
        <string>[Grapevine].Leaf.InitialisedCohortNo</string>
        <string>[Grapevine].Leaf.DeadCohortNo</string>
        <string>[Grapevine].Leaf.AppearedCohortNo</string>
        <string>[Grapevine].Leaf.CohortSize</string>
        <string>[Grapevine].Leaf.Fn</string>
        <string>[Grapevine].Leaf.Fw</string>
        <string>[Grapevine].Berry.Number</string>
        <string>[Grapevine].Berry.Live.Wt</string>
        <string>[Berry].MeanFloweringTempY0.Value()</string>
        <string>[Berry].MeanFloweringTemp.Value()</string>
        <string>[Berry].NumberFunction.Value()</string>
        <string>[Berry].NumberFunction.Shoots.Value()</string>
        <string>[Berry].NumberFunction.BunchesPerShoot.Value()</string>
        <string>[Berry].NumberFunction.PotentialBerriesPerBunch.Value()</string>
      </VariableNames>
      <EventNames>
        <string>[Clock].DoReport</string>
      </EventNames>
    </Report>
  </Replacements>
  <DataStore>
    <Name>DataStore</Name>
    <ExcelInput>
      <Name>PhenoObs</Name>
      <FileName>Observations\PhenoDataObservation.xlsx</FileName>
      <SheetNames>
        <string>Data</string>
      </SheetNames>
    </ExcelInput>
    <PredictedObserved>
      <Name>PhenoPredObs</Name>
      <Tests>
        <Name>Tests</Name>
        <AcceptedStats>
          <RegrStats>
            <Name>Grapevine.Phenology.BudBurstDOY.Value()</Name>
            <n>40</n>
            <Slope>0.29392748997457585</Slope>
            <Intercept>175.48089041657934</Intercept>
            <SEslope>0.19706687795559294</SEslope>
            <SEintercept>54.8840807636668</SEintercept>
            <R2>0.055304610561405454</R2>
            <RMSE>22.507221063472052</RMSE>
            <NSE>-15.583190113757265</NSE>
            <ME>-21.125</ME>
            <MAE>21.675</MAE>
            <RSR>4.0210210594963725</RSR>
          </RegrStats>
          <RegrStats>
            <Name>Grapevine.Phenology.FloweringDOY.Value()</Name>
            <n>42</n>
            <Slope>0.42259919973356375</Slope>
            <Intercept>179.33736245404097</Intercept>
            <SEslope>0.1485496835960167</SEslope>
            <SEintercept>51.375737567079533</SEintercept>
            <R2>0.16827952580715355</R2>
            <RMSE>21.131109992705294</RMSE>
            <NSE>-15.415221740580197</NSE>
            <ME>-20.333333333333332</ME>
            <MAE>20.333333333333332</MAE>
            <RSR>4.003046730642704</RSR>
          </RegrStats>
          <RegrStats>
            <Name>Grapevine.Phenology.VeraisonDOY.Value()</Name>
            <n>36</n>
            <Slope>1.6198912726919681</Slope>
            <Intercept>-66.500776623628511</Intercept>
            <SEslope>3.7808341758419006</SEslope>
            <SEintercept>282.896634489324</SEintercept>
            <R2>0.0053700593131866814</R2>
            <RMSE>125.99371677455454</RMSE>
            <NSE>-498.30210659159309</NSE>
            <ME>-20.25</ME>
            <MAE>100.52777777777777</MAE>
            <RSR>22.032535115839838</RSR>
          </RegrStats>
        </AcceptedStats>
        <AcceptedStatsName>Name n Slope Intercept SEslope SEintercept R2 RMSE NSE ME MAE RSR</AcceptedStatsName>
        <POName>PhenoPredObs</POName>
      </Tests>
      <PredictedTableName>Report</PredictedTableName>
      <ObservedTableName>Data</ObservedTableName>
      <FieldNameUsedForMatch>Grapevine.Phenology.CurrentStageName</FieldNameUsedForMatch>
      <FieldName2UsedForMatch>Clock.Today.Year</FieldName2UsedForMatch>
    </PredictedObserved>
    <AutoExport>false</AutoExport>
    <MaximumResultsPerPage>0</MaximumResultsPerPage>
  </DataStore>
  <Simulation>
    <Name>BaseSim</Name>
    <Zone>
      <Name>Vineyard</Name>
      <Soil>
        <Name>Soil</Name>
        <Water>
          <Name>Water</Name>
          <SoilCrop>
            <Name>GrapevineSoil</Name>
            <LL>
              <double>0.13</double>
              <double>0.13</double>
              <double>0.1</double>
              <double>0.15</double>
              <double>0.3</double>
              <double>0.3</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.01</double>
              <double>0</double>
              <double>0</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <Thickness>
            <double>100</double>
            <double>200</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.2</double>
            <double>1.2</double>
            <double>1.2</double>
            <double>1.2</double>
            <double>1.2</double>
            <double>1.2</double>
          </BD>
          <AirDry>
            <double>0.08</double>
            <double>0.16</double>
            <double>0.15</double>
            <double>0.13</double>
            <double>0.15</double>
            <double>0.15</double>
          </AirDry>
          <LL15>
            <double>0.16</double>
            <double>0.16</double>
            <double>0.15</double>
            <double>0.13</double>
            <double>0.15</double>
            <double>0.15</double>
          </LL15>
          <DUL>
            <double>0.33</double>
            <double>0.33</double>
            <double>0.31</double>
            <double>0.27</double>
            <double>0.3</double>
            <double>0.3</double>
          </DUL>
          <SAT>
            <double>0.5</double>
            <double>0.5</double>
            <double>0.44</double>
            <double>0.46</double>
            <double>0.44</double>
            <double>0.44</double>
          </SAT>
        </Water>
        <SoilWater>
          <Name>SoilWater</Name>
          <SummerDate>1-Nov</SummerDate>
          <SummerU>9</SummerU>
          <SummerCona>4.4</SummerCona>
          <WinterDate>1-Apr</WinterDate>
          <WinterU>9</WinterU>
          <WinterCona>4.4</WinterCona>
          <DiffusConst>88</DiffusConst>
          <DiffusSlope>35.4</DiffusSlope>
          <Salb>0.18</Salb>
          <CN2Bare>0</CN2Bare>
          <CNRed>-9E-05</CNRed>
          <CNCov>0</CNCov>
          <slope>0</slope>
          <discharge_width>0</discharge_width>
          <catchment_area>0</catchment_area>
          <max_pond>0</max_pond>
          <Thickness>
            <double>100</double>
            <double>200</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.55</double>
            <double>0.55</double>
            <double>0.55</double>
            <double>0.55</double>
            <double>0.55</double>
            <double>0.55</double>
          </SWCON>
          <KLAT>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </KLAT>
          <residueinterception>0</residueinterception>
        </SoilWater>
        <SoilNitrogen>
          <Name>SoilNitrogen</Name>
          <fom_type>
            <string>default</string>
            <string>manure</string>
            <string>mucuna</string>
            <string>lablab</string>
            <string>shemp</string>
            <string>stable</string>
          </fom_type>
          <fract_carb>
            <double>0.2</double>
            <double>0.3</double>
            <double>0.54</double>
            <double>0.57</double>
            <double>0.45</double>
            <double>0</double>
          </fract_carb>
          <fract_cell>
            <double>0.7</double>
            <double>0.3</double>
            <double>0.37</double>
            <double>0.37</double>
            <double>0.47</double>
            <double>0.1</double>
          </fract_cell>
          <fract_lign>
            <double>0.1</double>
            <double>0.4</double>
            <double>0.09</double>
            <double>0.06</double>
            <double>0.08</double>
            <double>0.9</double>
          </fract_lign>
          <urea_min>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </urea_min>
          <nh4_min>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </nh4_min>
          <no3_min>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </no3_min>
          <wfpsN2N2O_x>
            <double>22</double>
            <double>88</double>
          </wfpsN2N2O_x>
          <wfpsN2N2O_y>
            <double>0.1</double>
            <double>1</double>
          </wfpsN2N2O_y>
          <oc>
            <double>3.5087566566696209</double>
            <double>2.5000446389987916</double>
            <double>1.2003447486804877</double>
            <double>1.0302553388102849</double>
            <double>0.4701677719053009</double>
            <double>0.47008570515145176</double>
          </oc>
        </SoilNitrogen>
        <SoilOrganicMatter>
          <Name>SoilOrganicMatter</Name>
          <RootCN>30</RootCN>
          <RootWt>3000</RootWt>
          <SoilCN>11.5</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>200</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <Depth>
            <string>0-10</string>
            <string>10-30</string>
            <string>30-60</string>
            <string>60-90</string>
            <string>90-120</string>
            <string>120-150</string>
          </Depth>
          <OC>
            <double>3.5</double>
            <double>2.5</double>
            <double>1.2</double>
            <double>1.03</double>
            <double>0.47</double>
            <double>0.47</double>
          </OC>
          <FBiom>
            <double>0.025</double>
            <double>0.025</double>
            <double>0.015</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.3</double>
            <double>0.4</double>
            <double>0.75</double>
            <double>0.9</double>
            <double>0.96</double>
            <double>0.96</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Name>Analysis</Name>
          <Thickness>
            <double>100</double>
            <double>200</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>6.6</double>
            <double>6.2</double>
            <double>5.7</double>
            <double>5.5</double>
            <double>5.5</double>
            <double>5.5</double>
          </PH>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <InitialWater>
          <Name>Initial water</Name>
          <PercentMethod>FilledFromTop</PercentMethod>
          <FractionFull>1</FractionFull>
          <DepthWetSoil>NaN</DepthWetSoil>
        </InitialWater>
        <Sample>
          <Name>Sample</Name>
          <Thickness>
            <double>100</double>
            <double>200</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>40</double>
            <double>30</double>
            <double>14</double>
            <double>14</double>
            <double>1.38</double>
            <double>1.38</double>
          </NO3>
          <NH4>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
          </NH4>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <RecordNumber>0</RecordNumber>
        <SoilType>Sedementary</SoilType>
        <LocalName>Lincoln</LocalName>
        <Site />
        <NearestTown />
        <Region />
        <NaturalVegetation />
        <Latitude>0</Latitude>
        <Longitude>0</Longitude>
      </Soil>
      <SurfaceOrganicMatter>
        <Name>SurfaceOrganicMatter</Name>
        <PondActive>no</PondActive>
        <ReportAdditions>no</ReportAdditions>
        <ReportRemovals>no</ReportRemovals>
        <ResidueTypes>
          <Name>ResidueTypes</Name>
          <LoadFromResource>ResidueTypes</LoadFromResource>
        </ResidueTypes>
        <TillageTypes>
          <Name>TillageTypesList</Name>
          <TillageType />
        </TillageTypes>
        <Pools>
          <Pool>
            <PoolName>Grapevine</PoolName>
            <ResidueType>Grapevine</ResidueType>
            <Mass>2000</Mass>
            <CNRatio>80</CNRatio>
            <CPRatio>NaN</CPRatio>
            <StandingFraction>0</StandingFraction>
          </Pool>
        </Pools>
        <PoolName>Grapevine</PoolName>
        <type>Grapevine</type>
        <mass>2000</mass>
        <standing_fraction>0</standing_fraction>
        <cpr />
        <cnr>80</cnr>
        <CriticalResidueWeight>2000</CriticalResidueWeight>
        <OptimumDecompTemp>20</OptimumDecompTemp>
        <MaxCumulativeEOS>20</MaxCumulativeEOS>
        <CNRatioDecompCoeff>0.277</CNRatioDecompCoeff>
        <CNRatioDecompThreshold>25</CNRatioDecompThreshold>
        <TotalLeachRain>25</TotalLeachRain>
        <MinRainToLeach>10</MinRainToLeach>
        <CriticalMinimumOrganicC>0.004</CriticalMinimumOrganicC>
        <DefaultCPRatio>0</DefaultCPRatio>
        <DefaultStandingFraction>0</DefaultStandingFraction>
        <StandingExtinctCoeff>0.5</StandingExtinctCoeff>
        <FractionFaecesAdded>0.5</FractionFaecesAdded>
      </SurfaceOrganicMatter>
      <MicroClimate>
        <Name>MicroClimate</Name>
        <a_interception>0</a_interception>
        <b_interception>1</b_interception>
        <c_interception>0</c_interception>
        <d_interception>0</d_interception>
        <soil_albedo>0.23</soil_albedo>
        <sun_angle>15</sun_angle>
        <soil_heat_flux_fraction>0.4</soil_heat_flux_fraction>
        <night_interception_fraction>0.5</night_interception_fraction>
        <refheight>2</refheight>
        <albedo>0.15</albedo>
        <emissivity>0.96</emissivity>
        <RadIntTotal>0</RadIntTotal>
      </MicroClimate>
      <Irrigation>
        <Name>Irrigation</Name>
      </Irrigation>
      <Fertiliser>
        <Name>Fertiliser</Name>
      </Fertiliser>
      <Plant>
        <Name>Grapevine</Name>
        <ResourceName>Grapevine</ResourceName>
        <CropType>Grapevine</CropType>
        <SowingDate>2005-05-01T00:00:00</SowingDate>
      </Plant>
      <Operations>
        <Name>Operations</Name>
        <Operation>
          <Date>2005-05-01</Date>
          <Action>[Grapevine].Sow(population: 0.1667, cultivar: "SauvignonBlanc", depth: 50, rowSpacing: 3100, budNumber:24);</Action>
        </Operation>
      </Operations>
      <Report>
        <Name>Report</Name>
        <ExperimentFactorNames />
        <ExperimentFactorValues />
        <VariableNames>
          <string />
        </VariableNames>
        <EventNames>
          <string>[Clock].DoReport</string>
        </EventNames>
      </Report>
      <Manager>
        <Name>Pruning</Name>
        <Script>
          <PruneDateString>15-May</PruneDateString>
        </Script>
        <Code><![CDATA[
using System;
using System.Collections.Generic;
using Models.Core;
using Models.PMF;
using Models.PMF.Interfaces;
using System.Xml.Serialization;

namespace Models
{
	[Serializable] 
	[System.Xml.Serialization.XmlInclude(typeof(Model))]
	public class Script : Model
	{
		[Link] Plant Grapevine;
		[Link] Clock Clock;

		[Description("Prune Date")]
		public string PruneDateString { get; set; }
		[XmlIgnore] private DateTime PruneDate { get; set; }
		[XmlIgnore] private RemovalFractions Remove { get; set; }
		
		[EventSubscribe("Commencing")]
		private void OnSimulationCommencing(object sender, EventArgs e)
		{
			Remove = new RemovalFractions();
		}
		
		[EventSubscribe("DoManagement")]
		private void OnDoManagement(object sender, EventArgs e)
		{
			//Set up  array of remove fractions to send with Cut method.  Each member in the array corresponds to an organ in the same order they are set up in.
			PruneDate = DateTime.Parse(PruneDateString);
						
			if (PruneDate.Month == Clock.Today.Month && PruneDate.Day == Clock.Today.Day)
			{
				Remove.SetPhenologyStage = 1;
				Grapevine.RemoveBiomass("Prune", Remove);
			}
		}
	}
}
			
				]]></Code>
      </Manager>
      <Area>1</Area>
      <Slope>0</Slope>
    </Zone>
    <Weather>
      <Name>Weather</Name>
      <FileName>%root%\Examples\WeatherFiles\lincoln.met</FileName>
      <ExcelWorkSheetName />
    </Weather>
    <Clock>
      <Name>Clock</Name>
      <StartDate>2005-04-30T00:00:00</StartDate>
      <EndDate>2007-09-05T00:00:00</EndDate>
    </Clock>
    <Summary>
      <Name>Summary</Name>
    </Summary>
    <SoilArbitrator>
      <Name>Soil Arbitrator</Name>
    </SoilArbitrator>
    <Graph>
      <Name>Phenology</Name>
      <Series>
        <Name>Series</Name>
        <Type>Scatter</Type>
        <XAxis>Bottom</XAxis>
        <YAxis>Left</YAxis>
        <ColourArgb>-16777216</ColourArgb>
        <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
        <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
        <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
        <Marker>None</Marker>
        <MarkerSize>Normal</MarkerSize>
        <Line>Solid</Line>
        <LineThickness>Normal</LineThickness>
        <TableName>Report</TableName>
        <XFieldName>Clock.Today</XFieldName>
        <YFieldName>Grapevine.Phenology.CurrentStageName</YFieldName>
        <ShowInLegend>false</ShowInLegend>
        <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
        <Cumulative>false</Cumulative>
        <CumulativeX>false</CumulativeX>
      </Series>
      <Axis>
        <Type>Bottom</Type>
        <Inverted>false</Inverted>
        <Minimum>NaN</Minimum>
        <Maximum>NaN</Maximum>
        <Interval>NaN</Interval>
      </Axis>
      <Axis>
        <Type>Left</Type>
        <Inverted>false</Inverted>
        <Minimum>NaN</Minimum>
        <Maximum>NaN</Maximum>
        <Interval>NaN</Interval>
      </Axis>
      <LegendPosition>TopLeft</LegendPosition>
      <DisabledSeries />
      <IncludeInDocumentation>false</IncludeInDocumentation>
    </Graph>
    <Graph>
      <Name>LeafNum</Name>
      <Series>
        <Name>Initiated</Name>
        <EventNamesOnGraph>
          <Name>EventNamesOnGraph</Name>
          <ColumnName>[Grapevine].Phenology.CurrentStageName</ColumnName>
        </EventNamesOnGraph>
        <Type>Scatter</Type>
        <XAxis>Bottom</XAxis>
        <YAxis>Left</YAxis>
        <ColourArgb>-16777216</ColourArgb>
        <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
        <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
        <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
        <Marker>None</Marker>
        <MarkerSize>Normal</MarkerSize>
        <Line>Solid</Line>
        <LineThickness>Normal</LineThickness>
        <TableName>Report</TableName>
        <XFieldName>Clock.Today</XFieldName>
        <YFieldName>Grapevine.Leaf.InitialisedCohortNo</YFieldName>
        <ShowInLegend>false</ShowInLegend>
        <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
        <Cumulative>false</Cumulative>
        <CumulativeX>false</CumulativeX>
      </Series>
      <Series>
        <Name>AppTips</Name>
        <Type>Scatter</Type>
        <XAxis>Bottom</XAxis>
        <YAxis>Left</YAxis>
        <ColourArgb>-1663232</ColourArgb>
        <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
        <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
        <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
        <Marker>None</Marker>
        <MarkerSize>Normal</MarkerSize>
        <Line>Solid</Line>
        <LineThickness>Normal</LineThickness>
        <TableName>Report</TableName>
        <XFieldName>Clock.Today</XFieldName>
        <YFieldName>Grapevine.Leaf.AppearedCohortNo</YFieldName>
        <ShowInLegend>true</ShowInLegend>
        <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
        <Cumulative>false</Cumulative>
        <CumulativeX>false</CumulativeX>
      </Series>
      <Series>
        <Name>Dead</Name>
        <Type>Scatter</Type>
        <XAxis>Bottom</XAxis>
        <YAxis>Left</YAxis>
        <ColourArgb>-2793984</ColourArgb>
        <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
        <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
        <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
        <Marker>None</Marker>
        <MarkerSize>Normal</MarkerSize>
        <Line>Solid</Line>
        <LineThickness>Normal</LineThickness>
        <TableName>Report</TableName>
        <XFieldName>Clock.Today</XFieldName>
        <YFieldName>Grapevine.Leaf.DeadCohortNo</YFieldName>
        <ShowInLegend>true</ShowInLegend>
        <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
        <Cumulative>false</Cumulative>
        <CumulativeX>false</CumulativeX>
      </Series>
      <Axis>
        <Type>Bottom</Type>
        <Inverted>false</Inverted>
        <Minimum>NaN</Minimum>
        <Maximum>NaN</Maximum>
        <Interval>NaN</Interval>
      </Axis>
      <Axis>
        <Type>Left</Type>
        <Inverted>false</Inverted>
        <Minimum>NaN</Minimum>
        <Maximum>NaN</Maximum>
        <Interval>NaN</Interval>
      </Axis>
      <LegendPosition>TopLeft</LegendPosition>
      <DisabledSeries />
      <IncludeInDocumentation>false</IncludeInDocumentation>
    </Graph>
    <Graph>
      <Name>LeafSize</Name>
      <Series>
        <Name>1</Name>
        <Type>Scatter</Type>
        <XAxis>Bottom</XAxis>
        <YAxis>Left</YAxis>
        <ColourArgb>-16777216</ColourArgb>
        <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
        <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
        <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
        <Marker>None</Marker>
        <MarkerSize>Small</MarkerSize>
        <Line>Solid</Line>
        <LineThickness>Normal</LineThickness>
        <TableName>Report</TableName>
        <XFieldName>Clock.Today</XFieldName>
        <YFieldName>Grapevine.Leaf.CohortSize(1)</YFieldName>
        <ShowInLegend>false</ShowInLegend>
        <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
        <Cumulative>false</Cumulative>
        <CumulativeX>false</CumulativeX>
      </Series>
      <Series>
        <Name>2</Name>
        <Type>Scatter</Type>
        <XAxis>Bottom</XAxis>
        <YAxis>Left</YAxis>
        <ColourArgb>-1663232</ColourArgb>
        <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
        <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
        <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
        <Marker>None</Marker>
        <MarkerSize>Small</MarkerSize>
        <Line>Solid</Line>
        <LineThickness>Normal</LineThickness>
        <TableName>Report</TableName>
        <XFieldName>Clock.Today</XFieldName>
        <YFieldName>Grapevine.Leaf.CohortSize(2)</YFieldName>
        <ShowInLegend>false</ShowInLegend>
        <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
        <Cumulative>false</Cumulative>
        <CumulativeX>false</CumulativeX>
      </Series>
      <Series>
        <Name>3</Name>
        <Type>Scatter</Type>
        <XAxis>Bottom</XAxis>
        <YAxis>Left</YAxis>
        <ColourArgb>-11094807</ColourArgb>
        <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
        <FactorIndexToVaryMarkers>0</FactorIndexToVaryMarkers>
        <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
        <Marker>None</Marker>
        <MarkerSize>Small</MarkerSize>
        <Line>Solid</Line>
        <LineThickness>Normal</LineThickness>
        <TableName>Report</TableName>
        <XFieldName>Clock.Today</XFieldName>
        <YFieldName>Grapevine.Leaf.CohortSize(3)</YFieldName>
        <ShowInLegend>false</ShowInLegend>
        <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
        <Cumulative>false</Cumulative>
        <CumulativeX>false</CumulativeX>
      </Series>
      <Series>
        <Name>4</Name>
        <Type>Scatter</Type>
        <XAxis>Bottom</XAxis>
        <YAxis>Left</YAxis>
        <ColourArgb>-16736653</ColourArgb>
        <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
        <FactorIndexToVaryMarkers>0</FactorIndexToVaryMarkers>
        <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
        <Marker>Star</Marker>
        <MarkerSize>Small</MarkerSize>
        <Line>Solid</Line>
        <LineThickness>Normal</LineThickness>
        <TableName>Report</TableName>
        <XFieldName>Clock.Today</XFieldName>
        <YFieldName>Grapevine.Leaf.CohortSize(4)</YFieldName>
        <ShowInLegend>false</ShowInLegend>
        <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
        <Cumulative>false</Cumulative>
        <CumulativeX>false</CumulativeX>
      </Series>
      <Series>
        <Name>5</Name>
        <Type>Scatter</Type>
        <XAxis>Bottom</XAxis>
        <YAxis>Left</YAxis>
        <ColourArgb>-16747854</ColourArgb>
        <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
        <FactorIndexToVaryMarkers>0</FactorIndexToVaryMarkers>
        <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
        <Marker>None</Marker>
        <MarkerSize>Small</MarkerSize>
        <Line>Solid</Line>
        <LineThickness>Normal</LineThickness>
        <TableName>Report</TableName>
        <XFieldName>Clock.Today</XFieldName>
        <YFieldName>Grapevine.Leaf.CohortSize(5)</YFieldName>
        <ShowInLegend>false</ShowInLegend>
        <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
        <Cumulative>false</Cumulative>
        <CumulativeX>false</CumulativeX>
      </Series>
      <Series>
        <Name>6</Name>
        <Type>Scatter</Type>
        <XAxis>Bottom</XAxis>
        <YAxis>Left</YAxis>
        <ColourArgb>-2793984</ColourArgb>
        <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
        <FactorIndexToVaryMarkers>0</FactorIndexToVaryMarkers>
        <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
        <Marker>None</Marker>
        <MarkerSize>Small</MarkerSize>
        <Line>Solid</Line>
        <LineThickness>Normal</LineThickness>
        <TableName>Report</TableName>
        <XFieldName>Clock.Today</XFieldName>
        <YFieldName>Grapevine.Leaf.CohortSize(6)</YFieldName>
        <ShowInLegend>false</ShowInLegend>
        <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
        <Cumulative>false</Cumulative>
        <CumulativeX>false</CumulativeX>
      </Series>
      <Series>
        <Name>7</Name>
        <Type>Scatter</Type>
        <XAxis>Bottom</XAxis>
        <YAxis>Left</YAxis>
        <ColourArgb>-3376729</ColourArgb>
        <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
        <FactorIndexToVaryMarkers>0</FactorIndexToVaryMarkers>
        <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
        <Marker>None</Marker>
        <MarkerSize>Small</MarkerSize>
        <Line>Solid</Line>
        <LineThickness>Normal</LineThickness>
        <TableName>Report</TableName>
        <XFieldName>Clock.Today</XFieldName>
        <YFieldName>Grapevine.Leaf.CohortSize(7)</YFieldName>
        <ShowInLegend>false</ShowInLegend>
        <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
        <Cumulative>false</Cumulative>
        <CumulativeX>false</CumulativeX>
      </Series>
      <Series>
        <Name>8</Name>
        <Type>Scatter</Type>
        <XAxis>Bottom</XAxis>
        <YAxis>Left</YAxis>
        <ColourArgb>-990142</ColourArgb>
        <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
        <FactorIndexToVaryMarkers>0</FactorIndexToVaryMarkers>
        <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
        <Marker>None</Marker>
        <MarkerSize>Small</MarkerSize>
        <Line>Solid</Line>
        <LineThickness>Normal</LineThickness>
        <TableName>Report</TableName>
        <XFieldName>Clock.Today</XFieldName>
        <YFieldName>Grapevine.Leaf.CohortSize(8)</YFieldName>
        <ShowInLegend>false</ShowInLegend>
        <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
        <Cumulative>false</Cumulative>
        <CumulativeX>false</CumulativeX>
      </Series>
      <Series>
        <Name>9</Name>
        <Type>Scatter</Type>
        <XAxis>Bottom</XAxis>
        <YAxis>Left</YAxis>
        <ColourArgb>-16777216</ColourArgb>
        <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
        <FactorIndexToVaryMarkers>0</FactorIndexToVaryMarkers>
        <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
        <Marker>None</Marker>
        <MarkerSize>Normal</MarkerSize>
        <Line>Solid</Line>
        <LineThickness>Normal</LineThickness>
        <TableName>Report</TableName>
        <XFieldName>Clock.Today</XFieldName>
        <YFieldName>Grapevine.Leaf.CohortSize(9)</YFieldName>
        <ShowInLegend>false</ShowInLegend>
        <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
        <Cumulative>false</Cumulative>
        <CumulativeX>false</CumulativeX>
      </Series>
      <Series>
        <Name>10</Name>
        <Type>Scatter</Type>
        <XAxis>Bottom</XAxis>
        <YAxis>Left</YAxis>
        <ColourArgb>-1663232</ColourArgb>
        <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
        <FactorIndexToVaryMarkers>0</FactorIndexToVaryMarkers>
        <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
        <Marker>None</Marker>
        <MarkerSize>Normal</MarkerSize>
        <Line>Solid</Line>
        <LineThickness>Normal</LineThickness>
        <TableName>Report</TableName>
        <XFieldName>Clock.Today</XFieldName>
        <YFieldName>Grapevine.Leaf.CohortSize(10)</YFieldName>
        <ShowInLegend>false</ShowInLegend>
        <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
        <Cumulative>false</Cumulative>
        <CumulativeX>false</CumulativeX>
      </Series>
      <Series>
        <Name>11</Name>
        <Type>Scatter</Type>
        <XAxis>Bottom</XAxis>
        <YAxis>Left</YAxis>
        <ColourArgb>-11094807</ColourArgb>
        <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
        <FactorIndexToVaryMarkers>0</FactorIndexToVaryMarkers>
        <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
        <Marker>None</Marker>
        <MarkerSize>Normal</MarkerSize>
        <Line>Solid</Line>
        <LineThickness>Normal</LineThickness>
        <TableName>Report</TableName>
        <XFieldName>Clock.Today</XFieldName>
        <YFieldName>Grapevine.Leaf.CohortSize(11)</YFieldName>
        <ShowInLegend>false</ShowInLegend>
        <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
        <Cumulative>false</Cumulative>
        <CumulativeX>false</CumulativeX>
      </Series>
      <Series>
        <Name>12</Name>
        <Type>Scatter</Type>
        <XAxis>Bottom</XAxis>
        <YAxis>Left</YAxis>
        <ColourArgb>-16736653</ColourArgb>
        <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
        <FactorIndexToVaryMarkers>0</FactorIndexToVaryMarkers>
        <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
        <Marker>None</Marker>
        <MarkerSize>Normal</MarkerSize>
        <Line>Solid</Line>
        <LineThickness>Normal</LineThickness>
        <TableName>Report</TableName>
        <XFieldName>Clock.Today</XFieldName>
        <YFieldName>Grapevine.Leaf.CohortSize(12)</YFieldName>
        <ShowInLegend>true</ShowInLegend>
        <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
        <Cumulative>false</Cumulative>
        <CumulativeX>false</CumulativeX>
      </Series>
      <Series>
        <Name>13</Name>
        <Type>Scatter</Type>
        <XAxis>Bottom</XAxis>
        <YAxis>Left</YAxis>
        <ColourArgb>-16747854</ColourArgb>
        <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
        <FactorIndexToVaryMarkers>0</FactorIndexToVaryMarkers>
        <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
        <Marker>None</Marker>
        <MarkerSize>Normal</MarkerSize>
        <Line>Solid</Line>
        <LineThickness>Normal</LineThickness>
        <TableName>Report</TableName>
        <XFieldName>Clock.Today</XFieldName>
        <YFieldName>Grapevine.Leaf.CohortSize(13)</YFieldName>
        <ShowInLegend>false</ShowInLegend>
        <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
        <Cumulative>false</Cumulative>
        <CumulativeX>false</CumulativeX>
      </Series>
      <Series>
        <Name>14</Name>
        <Type>Scatter</Type>
        <XAxis>Bottom</XAxis>
        <YAxis>Left</YAxis>
        <ColourArgb>-2793984</ColourArgb>
        <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
        <FactorIndexToVaryMarkers>0</FactorIndexToVaryMarkers>
        <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
        <Marker>None</Marker>
        <MarkerSize>Normal</MarkerSize>
        <Line>Solid</Line>
        <LineThickness>Normal</LineThickness>
        <TableName>Report</TableName>
        <XFieldName>Clock.Today</XFieldName>
        <YFieldName>Grapevine.Leaf.CohortSize(14)</YFieldName>
        <ShowInLegend>false</ShowInLegend>
        <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
        <Cumulative>false</Cumulative>
        <CumulativeX>false</CumulativeX>
      </Series>
      <Series>
        <Name>15</Name>
        <Type>Scatter</Type>
        <XAxis>Bottom</XAxis>
        <YAxis>Left</YAxis>
        <ColourArgb>-3376729</ColourArgb>
        <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
        <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
        <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
        <Marker>None</Marker>
        <MarkerSize>Normal</MarkerSize>
        <Line>Solid</Line>
        <LineThickness>Normal</LineThickness>
        <TableName>Report</TableName>
        <XFieldName>Clock.Today</XFieldName>
        <YFieldName>Grapevine.Leaf.CohortSize(15)</YFieldName>
        <ShowInLegend>false</ShowInLegend>
        <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
        <Cumulative>false</Cumulative>
        <CumulativeX>false</CumulativeX>
      </Series>
      <Series>
        <Name>16</Name>
        <Type>Scatter</Type>
        <XAxis>Bottom</XAxis>
        <YAxis>Left</YAxis>
        <ColourArgb>-990142</ColourArgb>
        <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
        <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
        <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
        <Marker>None</Marker>
        <MarkerSize>Normal</MarkerSize>
        <Line>Solid</Line>
        <LineThickness>Normal</LineThickness>
        <TableName>Report</TableName>
        <XFieldName>Clock.Today</XFieldName>
        <YFieldName>Grapevine.Leaf.CohortSize(16)</YFieldName>
        <ShowInLegend>false</ShowInLegend>
        <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
        <Cumulative>false</Cumulative>
        <CumulativeX>false</CumulativeX>
      </Series>
      <Series>
        <Name>17</Name>
        <Type>Scatter</Type>
        <XAxis>Bottom</XAxis>
        <YAxis>Left</YAxis>
        <ColourArgb>-16777216</ColourArgb>
        <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
        <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
        <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
        <Marker>None</Marker>
        <MarkerSize>Normal</MarkerSize>
        <Line>Solid</Line>
        <LineThickness>Normal</LineThickness>
        <TableName>Report</TableName>
        <XFieldName>Clock.Today</XFieldName>
        <YFieldName>Grapevine.Leaf.CohortSize(17)</YFieldName>
        <ShowInLegend>false</ShowInLegend>
        <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
        <Cumulative>false</Cumulative>
        <CumulativeX>false</CumulativeX>
      </Series>
      <Series>
        <Name>18</Name>
        <Type>Scatter</Type>
        <XAxis>Bottom</XAxis>
        <YAxis>Left</YAxis>
        <ColourArgb>-1663232</ColourArgb>
        <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
        <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
        <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
        <Marker>None</Marker>
        <MarkerSize>Normal</MarkerSize>
        <Line>Solid</Line>
        <LineThickness>Normal</LineThickness>
        <TableName>Report</TableName>
        <XFieldName>Clock.Today</XFieldName>
        <YFieldName>Grapevine.Leaf.CohortSize(18)</YFieldName>
        <ShowInLegend>false</ShowInLegend>
        <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
        <Cumulative>false</Cumulative>
        <CumulativeX>false</CumulativeX>
      </Series>
      <Axis>
        <Type>Bottom</Type>
        <Title />
        <Inverted>false</Inverted>
        <Minimum>NaN</Minimum>
        <Maximum>NaN</Maximum>
        <Interval>NaN</Interval>
      </Axis>
      <Axis>
        <Type>Left</Type>
        <Title>Predicted Leaf Size (mm^2)</Title>
        <Inverted>false</Inverted>
        <Minimum>NaN</Minimum>
        <Maximum>NaN</Maximum>
        <Interval>NaN</Interval>
      </Axis>
      <LegendPosition>TopLeft</LegendPosition>
      <DisabledSeries />
      <IncludeInDocumentation>false</IncludeInDocumentation>
    </Graph>
    <Folder>
      <Name>Berry</Name>
      <Graph>
        <Name>MeanFloweringTemp</Name>
        <Series>
          <Name>MeanFloweringTemp</Name>
          <Type>Scatter</Type>
          <XAxis>Bottom</XAxis>
          <YAxis>Left</YAxis>
          <ColourArgb>-16777216</ColourArgb>
          <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
          <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
          <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
          <Marker>None</Marker>
          <MarkerSize>Normal</MarkerSize>
          <Line>Solid</Line>
          <LineThickness>Normal</LineThickness>
          <TableName>Report</TableName>
          <XFieldName>Clock.Today</XFieldName>
          <YFieldName>Berry.MeanFloweringTemp.Value()</YFieldName>
          <ShowInLegend>true</ShowInLegend>
          <IncludeSeriesNameInLegend>true</IncludeSeriesNameInLegend>
          <Cumulative>false</Cumulative>
          <CumulativeX>false</CumulativeX>
        </Series>
        <Series>
          <Name>MeanFloweringTempY0</Name>
          <Type>Scatter</Type>
          <XAxis>Bottom</XAxis>
          <YAxis>Left</YAxis>
          <ColourArgb>-1663232</ColourArgb>
          <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
          <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
          <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
          <Marker>None</Marker>
          <MarkerSize>Normal</MarkerSize>
          <Line>Solid</Line>
          <LineThickness>Normal</LineThickness>
          <TableName>Report</TableName>
          <XFieldName>Clock.Today</XFieldName>
          <YFieldName>Berry.MeanFloweringTempY0.Value()</YFieldName>
          <ShowInLegend>true</ShowInLegend>
          <IncludeSeriesNameInLegend>true</IncludeSeriesNameInLegend>
          <Cumulative>false</Cumulative>
          <CumulativeX>false</CumulativeX>
        </Series>
        <Axis>
          <Type>Bottom</Type>
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <Axis>
          <Type>Left</Type>
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <LegendPosition>TopLeft</LegendPosition>
        <DisabledSeries />
        <IncludeInDocumentation>false</IncludeInDocumentation>
      </Graph>
      <Graph>
        <Name>ShootandBunchNum</Name>
        <Series>
          <Name>ShootNum</Name>
          <Type>Scatter</Type>
          <XAxis>Bottom</XAxis>
          <YAxis>Left</YAxis>
          <ColourArgb>-1663232</ColourArgb>
          <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
          <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
          <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
          <Marker>None</Marker>
          <MarkerSize>Normal</MarkerSize>
          <Line>Solid</Line>
          <LineThickness>Normal</LineThickness>
          <TableName>Report</TableName>
          <XFieldName>Clock.Today</XFieldName>
          <YFieldName>Berry.NumberFunction.Shoots.Value()</YFieldName>
          <ShowInLegend>true</ShowInLegend>
          <IncludeSeriesNameInLegend>true</IncludeSeriesNameInLegend>
          <Cumulative>false</Cumulative>
          <CumulativeX>false</CumulativeX>
        </Series>
        <Series>
          <Name>BunchPerShoot</Name>
          <Type>Scatter</Type>
          <XAxis>Bottom</XAxis>
          <YAxis>Left</YAxis>
          <ColourArgb>-16777216</ColourArgb>
          <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
          <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
          <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
          <Marker>None</Marker>
          <MarkerSize>Normal</MarkerSize>
          <Line>Solid</Line>
          <LineThickness>Normal</LineThickness>
          <TableName>Report</TableName>
          <XFieldName>Clock.Today</XFieldName>
          <YFieldName>Berry.NumberFunction.BunchesPerShoot.Value()</YFieldName>
          <ShowInLegend>true</ShowInLegend>
          <IncludeSeriesNameInLegend>true</IncludeSeriesNameInLegend>
          <Cumulative>false</Cumulative>
          <CumulativeX>false</CumulativeX>
        </Series>
        <Axis>
          <Type>Bottom</Type>
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <Axis>
          <Type>Left</Type>
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <LegendPosition>TopRight</LegendPosition>
        <DisabledSeries />
        <IncludeInDocumentation>false</IncludeInDocumentation>
      </Graph>
      <Graph>
        <Name>BerryNum</Name>
        <Series>
          <Name>BerryPerBunch</Name>
          <Type>Scatter</Type>
          <XAxis>Bottom</XAxis>
          <YAxis>Left</YAxis>
          <ColourArgb>-2793984</ColourArgb>
          <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
          <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
          <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
          <Marker>None</Marker>
          <MarkerSize>Normal</MarkerSize>
          <Line>Solid</Line>
          <LineThickness>Normal</LineThickness>
          <TableName>Report</TableName>
          <XFieldName>Clock.Today</XFieldName>
          <YFieldName>Berry.NumberFunction.PotentialBerriesPerBunch.Value()</YFieldName>
          <ShowInLegend>true</ShowInLegend>
          <IncludeSeriesNameInLegend>true</IncludeSeriesNameInLegend>
          <Cumulative>false</Cumulative>
          <CumulativeX>false</CumulativeX>
        </Series>
        <Series>
          <Name>TotalNumberPerM2</Name>
          <Type>Scatter</Type>
          <XAxis>Bottom</XAxis>
          <YAxis>Right</YAxis>
          <ColourArgb>-16777216</ColourArgb>
          <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
          <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
          <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
          <Marker>None</Marker>
          <MarkerSize>Normal</MarkerSize>
          <Line>Solid</Line>
          <LineThickness>Normal</LineThickness>
          <TableName>Report</TableName>
          <XFieldName>Clock.Today</XFieldName>
          <YFieldName>Berry.NumberFunction.Value()</YFieldName>
          <ShowInLegend>true</ShowInLegend>
          <IncludeSeriesNameInLegend>true</IncludeSeriesNameInLegend>
          <Cumulative>false</Cumulative>
          <CumulativeX>false</CumulativeX>
        </Series>
        <Axis>
          <Type>Bottom</Type>
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <Axis>
          <Type>Left</Type>
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <Axis>
          <Type>Right</Type>
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <LegendPosition>TopRight</LegendPosition>
        <DisabledSeries />
        <IncludeInDocumentation>false</IncludeInDocumentation>
      </Graph>
      <Graph>
        <Name>BerryWT</Name>
        <Series>
          <Name>dryMass</Name>
          <Type>Scatter</Type>
          <XAxis>Bottom</XAxis>
          <YAxis>Left</YAxis>
          <ColourArgb>-16777216</ColourArgb>
          <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
          <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
          <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
          <Marker>None</Marker>
          <MarkerSize>Normal</MarkerSize>
          <Line>Solid</Line>
          <LineThickness>Normal</LineThickness>
          <TableName>Report</TableName>
          <XFieldName>Clock.Today</XFieldName>
          <YFieldName>Grapevine.Berry.Live.Wt</YFieldName>
          <ShowInLegend>false</ShowInLegend>
          <IncludeSeriesNameInLegend>true</IncludeSeriesNameInLegend>
          <Cumulative>false</Cumulative>
          <CumulativeX>false</CumulativeX>
        </Series>
        <Axis>
          <Type>Bottom</Type>
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <Axis>
          <Type>Left</Type>
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <LegendPosition>TopLeft</LegendPosition>
        <DisabledSeries />
        <IncludeInDocumentation>false</IncludeInDocumentation>
      </Graph>
    </Folder>
    <Graph>
      <Name>NWaterStress</Name>
      <Series>
        <Name>NStress</Name>
        <EventNamesOnGraph>
          <Name>EventNamesOnGraph</Name>
          <ColumnName>Grapevine.Phenology.CurrentStageName</ColumnName>
        </EventNamesOnGraph>
        <Type>Scatter</Type>
        <XAxis>Bottom</XAxis>
        <YAxis>Left</YAxis>
        <ColourArgb>-16777216</ColourArgb>
        <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
        <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
        <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
        <Marker>None</Marker>
        <MarkerSize>Normal</MarkerSize>
        <Line>Solid</Line>
        <LineThickness>Normal</LineThickness>
        <TableName>Report</TableName>
        <XFieldName>Clock.Today</XFieldName>
        <YFieldName>Grapevine.Leaf.Fn</YFieldName>
        <ShowInLegend>true</ShowInLegend>
        <IncludeSeriesNameInLegend>true</IncludeSeriesNameInLegend>
        <Cumulative>false</Cumulative>
        <CumulativeX>false</CumulativeX>
      </Series>
      <Series>
        <Name>WaterStress</Name>
        <EventNamesOnGraph>
          <Name>EventNamesOnGraph</Name>
          <ColumnName>Grapevine.Phenology.CurrentStageName</ColumnName>
        </EventNamesOnGraph>
        <Type>Scatter</Type>
        <XAxis>Bottom</XAxis>
        <YAxis>Left</YAxis>
        <ColourArgb>-2793984</ColourArgb>
        <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
        <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
        <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
        <Marker>None</Marker>
        <MarkerSize>Normal</MarkerSize>
        <Line>Solid</Line>
        <LineThickness>Normal</LineThickness>
        <TableName>Report</TableName>
        <XFieldName>Clock.Today</XFieldName>
        <YFieldName>Grapevine.Leaf.Fw</YFieldName>
        <ShowInLegend>true</ShowInLegend>
        <IncludeSeriesNameInLegend>true</IncludeSeriesNameInLegend>
        <Cumulative>false</Cumulative>
        <CumulativeX>false</CumulativeX>
      </Series>
      <Axis>
        <Type>Bottom</Type>
        <Inverted>false</Inverted>
        <Minimum>NaN</Minimum>
        <Maximum>NaN</Maximum>
        <Interval>NaN</Interval>
      </Axis>
      <Axis>
        <Type>Left</Type>
        <Inverted>false</Inverted>
        <Minimum>NaN</Minimum>
        <Maximum>NaN</Maximum>
        <Interval>NaN</Interval>
      </Axis>
      <LegendPosition>TopLeft</LegendPosition>
      <DisabledSeries />
      <IncludeInDocumentation>false</IncludeInDocumentation>
    </Graph>
  </Simulation>
  <Experiment>
    <Name>PhenoTest</Name>
    <Factors>
      <Name>Factors</Name>
      <Factor>
        <Name>Climate</Name>
        <Specifications>
          <string>[Weather].FileName = Site1001.met, Site1002.met, Site1003.met, Site1004.met</string>
        </Specifications>
      </Factor>
    </Factors>
    <Simulation>
      <Name>PhenologyBase</Name>
      <Weather>
        <Name>Weather</Name>
        <FileName>Site1003.met</FileName>
        <ExcelWorkSheetName />
      </Weather>
      <Clock>
        <Name>Clock</Name>
        <StartDate>2005-05-13T00:00:00</StartDate>
        <EndDate>2012-09-29T00:00:00</EndDate>
      </Clock>
      <Summary>
        <Name>Summary</Name>
      </Summary>
      <SoilArbitrator>
        <Name>Soil Arbitrator</Name>
      </SoilArbitrator>
      <Zone>
        <Name>Vineyard</Name>
        <Soil>
          <Name>Soil</Name>
          <Water>
            <Name>Water</Name>
            <SoilCrop>
              <Name>GrapevineSoil</Name>
              <LL>
                <double>0.13</double>
                <double>0.13</double>
                <double>0.1</double>
                <double>0.15</double>
                <double>0.3</double>
                <double>0.3</double>
              </LL>
              <KL>
                <double>0.1</double>
                <double>0.06</double>
                <double>0.04</double>
                <double>0.01</double>
                <double>0</double>
                <double>0</double>
              </KL>
              <XF>
                <double>1</double>
                <double>1</double>
                <double>1</double>
                <double>1</double>
                <double>0</double>
                <double>0</double>
              </XF>
            </SoilCrop>
            <Thickness>
              <double>100</double>
              <double>200</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <BD>
              <double>1.2</double>
              <double>1.2</double>
              <double>1.2</double>
              <double>1.2</double>
              <double>1.2</double>
              <double>1.2</double>
            </BD>
            <AirDry>
              <double>0.08</double>
              <double>0.16</double>
              <double>0.15</double>
              <double>0.13</double>
              <double>0.15</double>
              <double>0.15</double>
            </AirDry>
            <LL15>
              <double>0.16</double>
              <double>0.16</double>
              <double>0.15</double>
              <double>0.13</double>
              <double>0.15</double>
              <double>0.15</double>
            </LL15>
            <DUL>
              <double>0.33</double>
              <double>0.33</double>
              <double>0.31</double>
              <double>0.27</double>
              <double>0.3</double>
              <double>0.3</double>
            </DUL>
            <SAT>
              <double>0.5</double>
              <double>0.5</double>
              <double>0.44</double>
              <double>0.46</double>
              <double>0.44</double>
              <double>0.44</double>
            </SAT>
          </Water>
          <SoilWater>
            <Name>SoilWater</Name>
            <SummerDate>1-Nov</SummerDate>
            <SummerU>9</SummerU>
            <SummerCona>4.4</SummerCona>
            <WinterDate>1-Apr</WinterDate>
            <WinterU>9</WinterU>
            <WinterCona>4.4</WinterCona>
            <DiffusConst>88</DiffusConst>
            <DiffusSlope>35.4</DiffusSlope>
            <Salb>0.18</Salb>
            <CN2Bare>0</CN2Bare>
            <CNRed>-9E-05</CNRed>
            <CNCov>0</CNCov>
            <slope>0</slope>
            <discharge_width>0</discharge_width>
            <catchment_area>0</catchment_area>
            <max_pond>0</max_pond>
            <Thickness>
              <double>100</double>
              <double>200</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <SWCON>
              <double>0.55</double>
              <double>0.55</double>
              <double>0.55</double>
              <double>0.55</double>
              <double>0.55</double>
              <double>0.55</double>
            </SWCON>
            <KLAT>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </KLAT>
            <residueinterception>0</residueinterception>
          </SoilWater>
          <SoilNitrogen>
            <Name>SoilNitrogen</Name>
            <fom_type>
              <string>default</string>
              <string>manure</string>
              <string>mucuna</string>
              <string>lablab</string>
              <string>shemp</string>
              <string>stable</string>
            </fom_type>
            <fract_carb>
              <double>0.2</double>
              <double>0.3</double>
              <double>0.54</double>
              <double>0.57</double>
              <double>0.45</double>
              <double>0</double>
            </fract_carb>
            <fract_cell>
              <double>0.7</double>
              <double>0.3</double>
              <double>0.37</double>
              <double>0.37</double>
              <double>0.47</double>
              <double>0.1</double>
            </fract_cell>
            <fract_lign>
              <double>0.1</double>
              <double>0.4</double>
              <double>0.09</double>
              <double>0.06</double>
              <double>0.08</double>
              <double>0.9</double>
            </fract_lign>
            <urea_min>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </urea_min>
            <nh4_min>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </nh4_min>
            <no3_min>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </no3_min>
            <wfpsN2N2O_x>
              <double>22</double>
              <double>88</double>
            </wfpsN2N2O_x>
            <wfpsN2N2O_y>
              <double>0.1</double>
              <double>1</double>
            </wfpsN2N2O_y>
            <oc>
              <double>3.5087566566696209</double>
              <double>2.5000446389987916</double>
              <double>1.2003447486804877</double>
              <double>1.0302553388102849</double>
              <double>0.4701677719053009</double>
              <double>0.47008570515145176</double>
            </oc>
          </SoilNitrogen>
          <SoilOrganicMatter>
            <Name>SoilOrganicMatter</Name>
            <RootCN>30</RootCN>
            <RootWt>3000</RootWt>
            <SoilCN>11.5</SoilCN>
            <EnrACoeff>7.4</EnrACoeff>
            <EnrBCoeff>0.2</EnrBCoeff>
            <Thickness>
              <double>100</double>
              <double>200</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <Depth>
              <string>0-10</string>
              <string>10-30</string>
              <string>30-60</string>
              <string>60-90</string>
              <string>90-120</string>
              <string>120-150</string>
            </Depth>
            <OC>
              <double>3.5</double>
              <double>2.5</double>
              <double>1.2</double>
              <double>1.03</double>
              <double>0.47</double>
              <double>0.47</double>
            </OC>
            <FBiom>
              <double>0.025</double>
              <double>0.025</double>
              <double>0.015</double>
              <double>0.01</double>
              <double>0.01</double>
              <double>0.01</double>
            </FBiom>
            <FInert>
              <double>0.3</double>
              <double>0.4</double>
              <double>0.75</double>
              <double>0.9</double>
              <double>0.96</double>
              <double>0.96</double>
            </FInert>
            <OCUnits>Total</OCUnits>
          </SoilOrganicMatter>
          <Analysis>
            <Name>Analysis</Name>
            <Thickness>
              <double>100</double>
              <double>200</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <PH>
              <double>6.6</double>
              <double>6.2</double>
              <double>5.7</double>
              <double>5.5</double>
              <double>5.5</double>
              <double>5.5</double>
            </PH>
            <PHUnits>Water</PHUnits>
            <BoronUnits>HotWater</BoronUnits>
          </Analysis>
          <InitialWater>
            <Name>Initial water</Name>
            <PercentMethod>FilledFromTop</PercentMethod>
            <FractionFull>1</FractionFull>
            <DepthWetSoil>NaN</DepthWetSoil>
          </InitialWater>
          <Sample>
            <Name>Sample</Name>
            <Thickness>
              <double>100</double>
              <double>200</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <NO3>
              <double>40</double>
              <double>30</double>
              <double>14</double>
              <double>14</double>
              <double>1.38</double>
              <double>1.38</double>
            </NO3>
            <NH4>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
            </NH4>
            <NO3Units>kgha</NO3Units>
            <NH4Units>kgha</NH4Units>
            <SWUnits>Volumetric</SWUnits>
            <OCUnits>Total</OCUnits>
            <PHUnits>Water</PHUnits>
          </Sample>
          <RecordNumber>0</RecordNumber>
          <SoilType>Sedementary</SoilType>
          <LocalName>Lincoln</LocalName>
          <Site />
          <NearestTown />
          <Region />
          <NaturalVegetation />
          <Latitude>0</Latitude>
          <Longitude>0</Longitude>
        </Soil>
        <SurfaceOrganicMatter>
          <Name>SurfaceOrganicMatter</Name>
          <PondActive>no</PondActive>
          <ReportAdditions>no</ReportAdditions>
          <ReportRemovals>no</ReportRemovals>
          <ResidueTypes>
            <Name>ResidueTypes</Name>
            <LoadFromResource>ResidueTypes</LoadFromResource>
          </ResidueTypes>
          <TillageTypes>
            <Name>TillageTypesList</Name>
            <TillageType />
          </TillageTypes>
          <Pools>
            <Pool>
              <PoolName>Grapevine</PoolName>
              <ResidueType>Grapevine</ResidueType>
              <Mass>2000</Mass>
              <CNRatio>80</CNRatio>
              <CPRatio>NaN</CPRatio>
              <StandingFraction>0</StandingFraction>
            </Pool>
          </Pools>
          <PoolName>Grapevine</PoolName>
          <type>Grapevine</type>
          <mass>2000</mass>
          <standing_fraction>0</standing_fraction>
          <cpr />
          <cnr>80</cnr>
          <CriticalResidueWeight>2000</CriticalResidueWeight>
          <OptimumDecompTemp>20</OptimumDecompTemp>
          <MaxCumulativeEOS>20</MaxCumulativeEOS>
          <CNRatioDecompCoeff>0.277</CNRatioDecompCoeff>
          <CNRatioDecompThreshold>25</CNRatioDecompThreshold>
          <TotalLeachRain>25</TotalLeachRain>
          <MinRainToLeach>10</MinRainToLeach>
          <CriticalMinimumOrganicC>0.004</CriticalMinimumOrganicC>
          <DefaultCPRatio>0</DefaultCPRatio>
          <DefaultStandingFraction>0</DefaultStandingFraction>
          <StandingExtinctCoeff>0.5</StandingExtinctCoeff>
          <FractionFaecesAdded>0.5</FractionFaecesAdded>
        </SurfaceOrganicMatter>
        <MicroClimate>
          <Name>MicroClimate</Name>
          <a_interception>0</a_interception>
          <b_interception>1</b_interception>
          <c_interception>0</c_interception>
          <d_interception>0</d_interception>
          <soil_albedo>0.23</soil_albedo>
          <sun_angle>15</sun_angle>
          <soil_heat_flux_fraction>0.4</soil_heat_flux_fraction>
          <night_interception_fraction>0.5</night_interception_fraction>
          <refheight>2</refheight>
          <albedo>0.15</albedo>
          <emissivity>0.96</emissivity>
          <RadIntTotal>0</RadIntTotal>
        </MicroClimate>
        <Irrigation>
          <Name>Irrigation</Name>
        </Irrigation>
        <Fertiliser>
          <Name>Fertiliser</Name>
        </Fertiliser>
        <Plant>
          <Name>Grapevine</Name>
          <ResourceName>Grapevine</ResourceName>
          <CropType>Grapevine</CropType>
          <SowingDate>2005-05-01T00:00:00</SowingDate>
        </Plant>
        <Operations>
          <Name>Operations</Name>
          <Operation>
            <Date>2005-05-13</Date>
            <Action>[Grapevine].Sow(population: 0.1667, cultivar: "SauvignonBlanc", depth: 50, rowSpacing: 3100, budNumber:24);</Action>
          </Operation>
        </Operations>
        <Report>
          <Name>Report</Name>
          <ExperimentFactorNames />
          <ExperimentFactorValues />
          <VariableNames>
            <string />
          </VariableNames>
          <EventNames>
            <string>[Clock].DoReport</string>
          </EventNames>
        </Report>
        <Manager>
          <Name>Pruning</Name>
          <Script>
            <PruneDateString>15-May</PruneDateString>
          </Script>
          <Code><![CDATA[
using System;
using System.Collections.Generic;
using Models.Core;
using Models.PMF;
using Models.PMF.Interfaces;
using System.Xml.Serialization;

namespace Models
{
	[Serializable] 
	[System.Xml.Serialization.XmlInclude(typeof(Model))]
	public class Script : Model
	{
		[Link] Plant Grapevine;
		[Link] Clock Clock;

		[Description("Prune Date")]
		public string PruneDateString { get; set; }
		[XmlIgnore] private DateTime PruneDate { get; set; }
		[XmlIgnore] private RemovalFractions Remove { get; set; }
		
		[EventSubscribe("Commencing")]
		private void OnSimulationCommencing(object sender, EventArgs e)
		{
			Remove = new RemovalFractions();
		}
		
		[EventSubscribe("DoManagement")]
		private void OnDoManagement(object sender, EventArgs e)
		{
			//Set up  array of remove fractions to send with Cut method.  Each member in the array corresponds to an organ in the same order they are set up in.
			PruneDate = DateTime.Parse(PruneDateString);
						
			if (PruneDate.Month == Clock.Today.Month && PruneDate.Day == Clock.Today.Day)
			{
				Remove.SetPhenologyStage = 1;
				Grapevine.RemoveBiomass("Prune", Remove);
			}
		}
	}
}
			
				]]></Code>
        </Manager>
        <Area>1</Area>
        <Slope>0</Slope>
      </Zone>
    </Simulation>
    <Folder>
      <Name>PhenoValidation</Name>
      <Graph>
        <Name>BudBurstPredic</Name>
        <Series>
          <Name>Series</Name>
          <Regression>
            <Name>Regression</Name>
            <ForEachSeries>false</ForEachSeries>
          </Regression>
          <Type>Scatter</Type>
          <XAxis>Bottom</XAxis>
          <YAxis>Left</YAxis>
          <ColourArgb>-1663232</ColourArgb>
          <FactorIndexToVaryColours>0</FactorIndexToVaryColours>
          <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
          <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
          <Marker>FilledCircle</Marker>
          <MarkerSize>Normal</MarkerSize>
          <Line>None</Line>
          <LineThickness>Normal</LineThickness>
          <TableName>PredictedObserved</TableName>
          <XFieldName>Observed.Grapevine.Phenology.BudBurstDOY.Value()</XFieldName>
          <YFieldName>Predicted.Grapevine.Phenology.BudBurstDOY.Value()</YFieldName>
          <ShowInLegend>true</ShowInLegend>
          <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
          <Cumulative>false</Cumulative>
          <CumulativeX>false</CumulativeX>
        </Series>
        <Axis>
          <Type>Bottom</Type>
          <Inverted>false</Inverted>
          <Minimum>200</Minimum>
          <Maximum>365</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <Axis>
          <Type>Left</Type>
          <Inverted>false</Inverted>
          <Minimum>200</Minimum>
          <Maximum>365</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <LegendPosition>TopLeft</LegendPosition>
        <DisabledSeries />
        <IncludeInDocumentation>false</IncludeInDocumentation>
      </Graph>
      <Graph>
        <Name>FloweringPred</Name>
        <Series>
          <Name>Series</Name>
          <Regression>
            <Name>Regression</Name>
            <ForEachSeries>false</ForEachSeries>
          </Regression>
          <Type>Scatter</Type>
          <XAxis>Bottom</XAxis>
          <YAxis>Left</YAxis>
          <ColourArgb>-1663232</ColourArgb>
          <FactorIndexToVaryColours>0</FactorIndexToVaryColours>
          <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
          <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
          <Marker>FilledCircle</Marker>
          <MarkerSize>Normal</MarkerSize>
          <Line>None</Line>
          <LineThickness>Normal</LineThickness>
          <TableName>PredictedObserved</TableName>
          <XFieldName>Observed.Grapevine.Phenology.FloweringDOY.Value()</XFieldName>
          <YFieldName>Predicted.Grapevine.Phenology.FloweringDOY.Value()</YFieldName>
          <ShowInLegend>true</ShowInLegend>
          <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
          <Cumulative>false</Cumulative>
          <CumulativeX>false</CumulativeX>
        </Series>
        <Axis>
          <Type>Bottom</Type>
          <Inverted>false</Inverted>
          <Minimum>250</Minimum>
          <Maximum>365</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <Axis>
          <Type>Left</Type>
          <Inverted>false</Inverted>
          <Minimum>250</Minimum>
          <Maximum>365</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <LegendPosition>TopLeft</LegendPosition>
        <DisabledSeries />
        <IncludeInDocumentation>false</IncludeInDocumentation>
      </Graph>
      <Graph>
        <Name>VeraisonPred</Name>
        <Series>
          <Name>Series</Name>
          <Regression>
            <Name>Regression</Name>
            <ForEachSeries>false</ForEachSeries>
          </Regression>
          <Type>Scatter</Type>
          <XAxis>Bottom</XAxis>
          <YAxis>Left</YAxis>
          <ColourArgb>-1663232</ColourArgb>
          <FactorIndexToVaryColours>0</FactorIndexToVaryColours>
          <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
          <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
          <Marker>FilledCircle</Marker>
          <MarkerSize>Normal</MarkerSize>
          <Line>None</Line>
          <LineThickness>Normal</LineThickness>
          <TableName>PredictedObserved</TableName>
          <XFieldName>Observed.Grapevine.Phenology.VeraisonDOY.Value()</XFieldName>
          <YFieldName>Predicted.Grapevine.Phenology.VeraisonDOY.Value()</YFieldName>
          <ShowInLegend>true</ShowInLegend>
          <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
          <Cumulative>false</Cumulative>
          <CumulativeX>false</CumulativeX>
        </Series>
        <Axis>
          <Type>Bottom</Type>
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <Axis>
          <Type>Left</Type>
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <LegendPosition>TopLeft</LegendPosition>
        <DisabledSeries />
        <IncludeInDocumentation>false</IncludeInDocumentation>
      </Graph>
    </Folder>
  </Experiment>
  <ExplorerWidth>416</ExplorerWidth>
</Simulations>